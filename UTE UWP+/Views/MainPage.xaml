<Page
    x:Class="UTE_UWP_.Views.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:UTE_UWP_"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    xmlns:ToolkitControls="using:Microsoft.Toolkit.Uwp.UI.Controls"
    muxc:BackdropMaterial.ApplyToRootOrPageBackground="True"
    mc:Ignorable="d"
    xmlns:appmodel="using:Windows.ApplicationModel" xmlns:diags="using:UltraTextEdit_UWP.UserControls"
    d:DesignHeight="564"
    d:DesignWidth="876">

    <Page.Resources>
        <Style x:Key="CrimsonToolbarContextualToggleButton" TargetType="ToggleButton">
            <Setter Property="BackgroundSizing" Value="OuterBorderEdge" />
            <Setter Property="Foreground" Value="{ThemeResource SystemAccentColor}" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="Padding" Value="{StaticResource ButtonPadding}" />
            <Setter Property="HorizontalAlignment" Value="Left" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontFamily" Value="{ThemeResource ContentControlThemeFontFamily}" />
            <Setter Property="FontWeight" Value="Normal" />
            <Setter Property="FontSize" Value="{ThemeResource ControlContentThemeFontSize}" />
            <Setter Property="UseSystemFocusVisuals" Value="{StaticResource UseSystemFocusVisuals}" />
            <Setter Property="FocusVisualMargin" Value="-3" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Grid x:Name="RootGrid" Background="Transparent" CornerRadius="4">

                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="Pipe" Storyboard.TargetProperty="Width" EnableDependentAnimation="True" Duration="0:0:0.12" To="0"/>
                                        </Storyboard>
                                    </VisualState>

                                    <VisualState x:Name="PointerOver">

                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Background">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBackgroundPointerOver}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="BorderBrush">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Null}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonForegroundPointerOver}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <DoubleAnimation Storyboard.TargetName="Pipe" Storyboard.TargetProperty="Width" EnableDependentAnimation="True" Duration="0:0:0.12" To="12"/>
                                        </Storyboard>
                                    </VisualState>

                                    <VisualState x:Name="Pressed">

                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Background">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBackgroundPressed}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="BorderBrush">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Null}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonForegroundPressed}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <DoubleAnimation Storyboard.TargetName="Pipe" Storyboard.TargetProperty="Width" EnableDependentAnimation="True" Duration="0:0:0.12" To="8"/>
                                        </Storyboard>
                                    </VisualState>

                                    <VisualState x:Name="Disabled">

                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Background">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBackgroundDisabled}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonForegroundDisabled}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="BorderBrush">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBorderBrushDisabled}" />
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>

                                    <VisualState x:Name="Checked">

                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="BorderBrush">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Null}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <DoubleAnimation Storyboard.TargetName="Pipe" Storyboard.TargetProperty="Width" EnableDependentAnimation="True" Duration="0:0:0.12" To="28"/>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="CheckedPointerOver">

                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Background">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBackgroundPointerOver}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <DoubleAnimation Storyboard.TargetName="Pipe" Storyboard.TargetProperty="Width" EnableDependentAnimation="True" Duration="0:0:0.12" To="32"/>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="CheckedPressed">

                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Background">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBackgroundPressed}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="BorderBrush">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Null}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <DoubleAnimation Storyboard.TargetName="Pipe" Storyboard.TargetProperty="Width" EnableDependentAnimation="True" Duration="0:0:0.12" To="24"/>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="CheckedDisabled">

                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Background">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBackgroundCheckedDisabled}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonForegroundCheckedDisabled}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="BorderBrush">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBorderBrushCheckedDisabled}" />
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Indeterminate">

                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Background">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBackgroundIndeterminate}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonForegroundIndeterminate}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="BorderBrush">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBorderBrushIndeterminate}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <PointerUpThemeAnimation Storyboard.TargetName="ContentPresenter" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="IndeterminatePointerOver">

                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Background">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBackgroundIndeterminatePointerOver}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="BorderBrush">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBorderBrushIndeterminatePointerOver}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonForegroundIndeterminatePointerOver}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <PointerUpThemeAnimation Storyboard.TargetName="ContentPresenter" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="IndeterminatePressed">

                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Background">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBackgroundIndeterminatePressed}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="BorderBrush">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBorderBrushIndeterminatePressed}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonForegroundIndeterminatePressed}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <PointerDownThemeAnimation Storyboard.TargetName="ContentPresenter" />
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="IndeterminateDisabled">

                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Background">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBackgroundIndeterminateDisabled}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="Foreground">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonForegroundIndeterminateDisabled}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter" Storyboard.TargetProperty="BorderBrush">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource ToggleButtonBorderBrushIndeterminateDisabled}" />
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>

                                </VisualStateGroup>

                            </VisualStateManager.VisualStateGroups>

                            <ContentPresenter x:Name="ContentPresenter"
              Background="{TemplateBinding Background}"
              BackgroundSizing="{TemplateBinding BackgroundSizing}"
              Foreground="{ThemeResource SystemAccentColor}"
              BorderBrush="{TemplateBinding BorderBrush}"
              BorderThickness="{TemplateBinding BorderThickness}"
              Content="{TemplateBinding Content}"
              ContentTemplate="{TemplateBinding ContentTemplate}"
              ContentTransitions="{TemplateBinding ContentTransitions}"
              CornerRadius="{TemplateBinding CornerRadius}"
              Padding="{TemplateBinding Padding}"
              HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
              VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
              Margin="0, 0, 0, 2"
              AutomationProperties.AccessibilityView="Raw"/>
                            <Grid x:Name="Pipe"
                Height="3" Width="0.1" CornerRadius="1.5,1.5,1.5,1.5"
                VerticalAlignment="Bottom" 
                HorizontalAlignment="Center" Background="{StaticResource AccentFillColorDefaultBrush}"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>


        <Style x:Key="TitleBarCaptionTextBlockStyle" TargetType="TextBlock" BasedOn="{StaticResource BaseTextBlockStyle}">
            <Setter Property="FontSize" Value="12" />
            <Setter Property="FontWeight" Value="Normal" />
            <Setter Property="Foreground" Value="{ThemeResource SystemAccentColor}"/>
        </Style>
        <Flyout x:Key="myColorPickerFlyout">
            <RelativePanel>
                <ColorPicker x:Name="myColorPicker"
                         IsColorChannelTextInputVisible="True"
                         IsHexInputVisible="True"/>

                <Grid RelativePanel.Below="myColorPicker"
                  RelativePanel.AlignLeftWithPanel="True"
                  RelativePanel.AlignRightWithPanel="True">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Button Content="OK" Click="ConfirmColor_Click"
                            Style="{StaticResource AccentButtonStyle}"
                        Margin="0,12,2,0" HorizontalAlignment="Stretch"/>
                    <Button Content="Cancel" Click="CancelColor_Click"
                        Margin="2,12,0,0" HorizontalAlignment="Stretch"
                        Grid.Column="1"/>
                </Grid>
            </RelativePanel>
        </Flyout>
    </Page.Resources>
    <Grid>
        <RelativePanel Background="{StaticResource TabViewItemHeaderBackground}">

            <RelativePanel
            x:Name="containerPanel"
            RelativePanel.AlignLeftWithPanel="True"
            RelativePanel.AlignRightWithPanel="True">
                <StackPanel x:Name="TitleBar" Orientation="Horizontal">
                    <Border
                x:Name="AppTitleBar"
                Height="40"
                Margin="12,2,0,0"
                VerticalAlignment="Top"
                Background="Transparent"
                Canvas.ZIndex="1"
                IsHitTestVisible="True"
                RelativePanel.AlignLeftWithPanel="True"
                RelativePanel.AlignRightWithPanel="True">
                        <StackPanel Orientation="Horizontal" Width="Auto">
                            <Image
                        x:Name="AppFontIcon"
                        Width="24"
                        Height="24"
                        Margin="0,2,0,0"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Source="ms-appx:///Assets/Square44x44Logo.png" />
                            <TextBlock
                        x:Name="AppTitle"
                        Margin="12,2,4,0"
                        VerticalAlignment="Center"
                        Text="Untitled - UTE UWP"
                        FontSize="12"
                        FontWeight="Normal" Foreground="{ThemeResource SystemAccentColor}"/>
                        </StackPanel>
                    </Border>
                    <TextBlock
                        x:Name="UnsavedTextBlock"
                        Padding="5,0"
                        VerticalAlignment="Center"
                        Text="* Not Saved"
                        ToolTipService.ToolTip="There are unsaved changes." />
                </StackPanel>

                <StackPanel
                x:Name="MenuPanel"
                VerticalAlignment="Center"
                Orientation="Horizontal"
                RelativePanel.Below="TitleBar">
                    <muxc:MenuBar
                    x:Name="menu"
                    Margin="5,0,0,0"
                    VerticalAlignment="Center">
                        <muxc:MenuBarItem Title="File" d:Title="File">
                            <muxc:MenuBarItem.Background>
                                <SolidColorBrush Color="{ThemeResource SystemAccentColor}"/>
                            </muxc:MenuBarItem.Background>
                            <MenuFlyoutItem Click="NewDoc_Click" Text="New Untabbed Window" x:Name="untabbedwindow">
                                <MenuFlyoutItem.Icon>
                                    <PathIcon Data="M18.5 20a.5.5 0 0 1-.5.5h-5.732A6.518 6.518 0 0 1 11.19 22H18a2 2 0 0 0 2-2V9.828a2 2 0 0 0-.586-1.414l-5.829-5.828a.491.491 0 0 0-.049-.04.63.63 0 0 1-.036-.03 2.072 2.072 0 0 0-.219-.18.652.652 0 0 0-.08-.044l-.048-.024-.05-.029c-.054-.031-.109-.063-.166-.087a1.977 1.977 0 0 0-.624-.138c-.02-.001-.04-.004-.059-.007A.605.605 0 0 0 12.172 2H6a2 2 0 0 0-2 2v7.498a6.451 6.451 0 0 1 1.5-.422V4a.5.5 0 0 1 .5-.5h6V8a2 2 0 0 0 2 2h4.5v10Zm-5-15.379L17.378 8.5H14a.5.5 0 0 1-.5-.5V4.621Z M12 17.5a5.5 5.5 0 1 0-11 0 5.5 5.5 0 0 0 11 0ZM7 18l.001 2.503a.5.5 0 1 1-1 0V18H3.496a.5.5 0 0 1 0-1H6v-2.5a.5.5 0 1 1 1 0V17h2.497a.5.5 0 0 1 0 1H7Z"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                            <MenuFlyoutItem Click="NewInstance_Click" Text="New Tabbed Window" x:Name="tabbedwindow">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE78B;" />
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                            <MenuFlyoutItem Click="OpenButton_Click" Text="Open" Icon="OpenFile"/>
                            <MenuFlyoutItem Click="SaveButton_Click" Text="Save" Icon="Save" x:Name="saveitem"/>
                            <MenuFlyoutItem Click="SaveAsButton_Click" Text="SaveAsCopy">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE792;" />
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                            <MenuFlyoutItem Click="Print_Click" Text="Print"  Icon="Print"/>
                            <MenuFlyoutSeparator />
                            <MenuFlyoutItem Click="Home_Click" Text="Home" Icon="Home"/>
                            <MenuFlyoutItem Click="FindButton2_Click" Text="Find/Replace" x:Name="finditem" Visibility="Collapsed">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE721;" />
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                            <MenuFlyoutSeparator />
                            <MenuFlyoutItem Click="Exit_Click" Text="Exit">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE8BB;" />
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                        </muxc:MenuBarItem>

                    </muxc:MenuBar>

                    <Button
                    VerticalAlignment="Center"
                    Background="Transparent"
                    BorderBrush="Transparent"
                    Click="UndoButton_Click"
                    ToolTipService.ToolTip="Undo">
                        <Viewbox MaxWidth="17" MaxHeight="17">
                            <SymbolIcon Symbol="Undo" />
                        </Viewbox>
                    </Button>

                    <Button
                    VerticalAlignment="Center"
                    Background="Transparent"
                    BorderBrush="Transparent"
                    Click="RedoButton_Click"
                    ToolTipService.ToolTip="Redo">
                        <Viewbox MaxWidth="17" MaxHeight="17">
                            <SymbolIcon Symbol="Redo" />
                        </Viewbox>
                    </Button>

                    <AppBarSeparator />

                    <Button
                    Background="Transparent"
                    BorderBrush="Transparent"
                    Click="ShareButton_Click"
                    ToolTipService.ToolTip="Share">
                        <Viewbox MaxWidth="17" MaxHeight="17">
                            <SymbolIcon Symbol="Share" />
                        </Viewbox>
                    </Button>

                    <Button
                    Background="Transparent"
                    BorderBrush="Transparent"
                    Click="CommentsButton_Click"
                    ToolTipService.ToolTip="Comment">
                        <Viewbox MaxWidth="17" MaxHeight="17">
                            <SymbolIcon Symbol="Message" />
                        </Viewbox>
                    </Button>

                    <Button
                    Background="Transparent"
                    BorderBrush="Transparent"
                    Click="SettingsButton_Click"
                    ToolTipService.ToolTip="Settings">
                        <Viewbox MaxWidth="17" MaxHeight="17">
                            <SymbolIcon Symbol="Setting" />
                        </Viewbox>
                    </Button>
                    <AppBarSeparator/>
                    <ToggleSwitch x:Name="ribbonToggle" OnContent="Ribbon" OffContent="TabbedCommandBar" Toggled="ribbonToggle_Toggled"/>
                </StackPanel>

                <controls:TabbedCommandBar
                x:Name="ButtonPanel"
                Margin="0,0,0,0"
                Padding="0,0,0,0"
                RelativePanel.Below="MenuPanel"
                RelativePanel.AlignLeftWithPanel="True"
                RelativePanel.AlignRightWithPanel="True"
                Background="Transparent">
                    <controls:TabbedCommandBar.MenuItems>
                        <controls:TabbedCommandBarItem Header="Home" Background="Transparent">
                            <AppBarToggleButton
                    Click="BoldButton_Click" x:Name="BoldButton"
                    Style="{StaticResource CrimsonToolbarToggleButton}"
                    ToolTipService.ToolTip="Bold">
                                <Viewbox MaxWidth="17" MaxHeight="17">
                                    <SymbolIcon Symbol="Bold" />
                                </Viewbox>
                            </AppBarToggleButton>

                            <AppBarToggleButton
                    Click="ItalicButton_Click" x:Name="ItalicButton"
                    Style="{StaticResource CrimsonToolbarToggleButton}"
                    ToolTipService.ToolTip="Italic">
                                <Viewbox MaxWidth="17" MaxHeight="17">
                                    <SymbolIcon Symbol="Italic" />
                                </Viewbox>
                            </AppBarToggleButton>
                            <AppBarToggleButton
                    Click="UnderlineButton_Click" x:Name="UnderlineButton"
                    Style="{StaticResource CrimsonToolbarToggleButton}"
                    ToolTipService.ToolTip="Underline">
                                <Viewbox MaxWidth="17" MaxHeight="17">
                                    <SymbolIcon Symbol="Underline" />
                                </Viewbox>
                            </AppBarToggleButton>
                            <AppBarToggleButton
                    Click="StrikethroughButton_Click" x:Name="StrikethroughButton"
                    Style="{StaticResource CrimsonToolbarToggleButton}"
                    ToolTipService.ToolTip="Strikethrough">
                                <FontIcon FontSize="17" Glyph="&#xEDE0;" />
                            </AppBarToggleButton>
                            <AppBarSeparator />
                            <AppBarButton
                    Click="AlignLeftButton_Click"
                    Style="{StaticResource CrimsonToolbarButton}"
                    ToolTipService.ToolTip="Align Left">
                                <Viewbox MaxWidth="17" MaxHeight="17">
                                    <SymbolIcon Symbol="AlignLeft" />
                                </Viewbox>
                            </AppBarButton>
                            <AppBarButton
                    Click="AlignCenterButton_Click"
                    Style="{StaticResource CrimsonToolbarButton}"
                    ToolTipService.ToolTip="Align Center">
                                <Viewbox MaxWidth="17" MaxHeight="17">
                                    <SymbolIcon Symbol="AlignCenter" />
                                </Viewbox>
                            </AppBarButton>
                            <AppBarButton
                    Click="AlignRightButton_Click"
                    Style="{StaticResource CrimsonToolbarButton}"
                    ToolTipService.ToolTip="Align Right">
                                <Viewbox MaxWidth="17" MaxHeight="17">
                                    <SymbolIcon Symbol="AlignRight" />
                                </Viewbox>
                            </AppBarButton>
                            <AppBarButton
Click="AlignJustifyButton_Click"
Style="{StaticResource CrimsonToolbarButton}"
ToolTipService.ToolTip="Justify">
                                <Viewbox MaxWidth="17" MaxHeight="17">
                                    <PathIcon Data="M2 6a1 1 0 0 1 1-1h18a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1ZM2 18a1 1 0 0 1 1-1h18a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1ZM3 11a1 1 0 1 0 0 2h18a1 1 0 1 0 0-2H3Z"/>
                                </Viewbox>
                            </AppBarButton>
                            <AppBarSeparator />
                            <AppBarElementContainer>
                                <!--<muxc:DropDownButton
                    x:Name="fontColorButton"
                    AutomationProperties.Name="FontColor"
                    BorderThickness="0"
                    RelativePanel.AlignRightWithPanel="True"
                    ToolTipService.ToolTip="FontColor">
                                <SymbolIcon Symbol="FontColor" />
                                <muxc:DropDownButton.Flyout>
                                    <Flyout Placement="Bottom">
                                        <RelativePanel>
                                            <VariableSizedWrapGrid
                                    x:Name="colorGrid"
                                    MaximumRowsOrColumns="4"
                                    Orientation="Horizontal">
                                                <VariableSizedWrapGrid.Resources>
                                                    <Style TargetType="Rectangle">
                                                        <Setter Property="Width" Value="32" />
                                                        <Setter Property="Height" Value="32" />
                                                    </Style>

                                                    <Style TargetType="Button">
                                                        <Setter Property="Padding" Value="0" />
                                                        <Setter Property="MinWidth" Value="0" />
                                                        <Setter Property="MinHeight" Value="0" />
                                                        <Setter Property="Margin" Value="5" />
                                                        <Setter Property="CornerRadius" Value="8" />
                                                    </Style>
                                                </VariableSizedWrapGrid.Resources>
                                                <Button
                                        AutomationProperties.Name="Red"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Red">
                                                    <Button.Content>
                                                        <Rectangle Fill="Red" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Orange"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Orange">
                                                    <Button.Content>
                                                        <Rectangle Fill="Orange" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Yellow"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Yellow">
                                                    <Button.Content>
                                                        <Rectangle Fill="Yellow" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Green"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Green">
                                                    <Button.Content>
                                                        <Rectangle Fill="Green" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Blue"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Blue">
                                                    <Button.Content>
                                                        <Rectangle Fill="Blue" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="LightBlue"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Light Blue">
                                                    <Button.Content>
                                                        <Rectangle Fill="LightBlue" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Indigo"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Indigo">
                                                    <Button.Content>
                                                        <Rectangle Fill="Indigo" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Violet"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Violet">
                                                    <Button.Content>
                                                        <Rectangle Fill="Violet" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Gray"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Gray">
                                                    <Button.Content>
                                                        <Rectangle Fill="Gray" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Beige"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Beige">
                                                    <Button.Content>
                                                        <Rectangle Fill="Beige" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Black"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Black">
                                                    <Button.Content>
                                                        <Rectangle Fill="Black" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="White"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="White">
                                                    <Button.Content>
                                                        <Rectangle Fill="White" />
                                                    </Button.Content>
                                                </Button>
                                            </VariableSizedWrapGrid>
                                            <Button
                                    x:Name="colorPickerButton"
                                    Width="173"
                                    Margin="0,8,0,0"
                                    Content="More colors"
                                    Flyout="{StaticResource myColorPickerFlyout}"
                                    RelativePanel.Below="colorGrid" />
                                        </RelativePanel>
                                    </Flyout>
                                </muxc:DropDownButton.Flyout>
                            </muxc:DropDownButton>-->
                                <muxc:SplitButton x:Name="fontcolorsplitbutton" Grid.Column="6" Content="&#xE186;" Grid.Row="1" FontFamily="{ThemeResource SymbolThemeFontFamily}" VerticalContentAlignment="Stretch" FontSize="16" Click="fontcolorsplitbutton_Click">
                                    <muxc:SplitButton.Flyout>
                                        <Flyout Placement="Bottom">
                                            <RelativePanel>
                                                <VariableSizedWrapGrid x:Name="colorGrid" MaximumRowsOrColumns="6" RelativePanel.Below="Autobutton" Margin="0,3,0,3">
                                                    <VariableSizedWrapGrid.Resources>
                                                        <Style TargetType="Rectangle">
                                                            <Setter Property="Width" Value="25"/>
                                                            <Setter Property="Height" Value="25"/>
                                                        </Style>

                                                        <Style TargetType="Button">
                                                            <Setter Property="Padding" Value="0"/>
                                                            <Setter Property="Width" Value="25"/>
                                                            <Setter Property="Height" Value="25"/>
                                                            <Setter Property="MinWidth" Value="0"/>
                                                            <Setter Property="MinHeight" Value="0"/>
                                                            <Setter Property="Margin" Value="3"/>
                                                            <Setter Property="CornerRadius" Value="15"/>
                                                            <Setter Property="Background"
                                Value="Transparent" />
                                                            <Setter Property="BackgroundSizing"
                                Value="OuterBorderEdge" />
                                                            <Setter Property="BorderBrush"
                                Value="Transparent" />
                                                            <Setter Property="Padding"
                                Value="0" />
                                                            <Setter Property="FontWeight"
                                Value="Normal" />
                                                            <Setter Property="FontSize"
                                Value="16" />


                                                        </Style>
                                                    </VariableSizedWrapGrid.Resources>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="White">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#ffffff"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Grey">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#a5a5a5"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Dark Grey">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#666666"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Dark Grey">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#666666"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Black">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#333333"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Black">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#000000"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Red" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#ff0000"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Orange" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#ffc000"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Yellow" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#ffff00"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Green" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#00b050"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Blue" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#004dbb"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Purple">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#9b00d3"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Brick Red">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#c0504d"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Orange">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#f79646"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Olive Green">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#9bbb59"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Turquoise">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#4bacc6"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Azure">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#4f81bd"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Slate Grey">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#8064a2"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Copper Red">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#d16349"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Earth Orange">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#d19049"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Dark Yellow" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#ccb400"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Light Mint" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#8fb08c"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Blue Grey" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#646b86"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Brown">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#9e7c7c"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Earth Red" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#dd8484"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Orange" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#f3a447"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Yellow" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#dfce04"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Muted Green" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#a5b592"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Muted Blue" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#809ec2"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Lilac">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#9c85c0"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                </VariableSizedWrapGrid>
                                                <Button Flyout="{StaticResource myColorPickerFlyout}" RelativePanel.Below="colorGrid" Width="154" x:Name="colorPickerButton" FontFamily="Segoe UI" FontSize="11" Height="34">
                                                    <Button.Content>
                                                        <Grid>
                                                            <TextBlock Text="More colors..." Margin="25,0,0,0"></TextBlock>
                                                            <FontIcon Glyph="" HorizontalAlignment="Left" FontSize="16"></FontIcon>
                                                        </Grid>
                                                    </Button.Content>
                                                </Button>
                                                <ToggleButton Width="155" x:Name="Autobutton" FontFamily="Segoe UI" Height="35" Click="Autobutton_Click">
                                                    <ToggleButton.Content>
                                                        <Grid>
                                                            <TextBlock Text="Automatic" Margin="25,0,0,0" FontSize="11"></TextBlock>
                                                            <FontIcon Glyph="" HorizontalAlignment="Left" FontSize="16"></FontIcon>
                                                        </Grid>
                                                    </ToggleButton.Content>
                                                </ToggleButton>
                                            </RelativePanel>
                                        </Flyout>
                                    </muxc:SplitButton.Flyout>
                                </muxc:SplitButton>
                            </AppBarElementContainer>
                            <AppBarElementContainer>
                                <muxc:NumberBox
                    x:Name="FontSizeBox"
                    MinWidth="120"
                    Maximum="150"
                    Minimum="8"
                    PlaceholderText="Font size"
                    SpinButtonPlacementMode="Compact"
                    ValueChanged="FontSizeBox_ValueChanged"
                    Value="11" />
                            </AppBarElementContainer>
                            <AppBarElementContainer>
                                <ComboBox
                    x:Name="FontsCombo"
                    IsTextSearchEnabled="True"
                    ItemsSource="{x:Bind fonts}"
                    PlaceholderText="Font"
                    SelectedItem="Segoe UI"
                    SelectionChanged="FontsCombo_SelectionChanged">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate x:DataType="x:String">
                                            <TextBlock FontFamily="{x:Bind}" Text="{x:Bind}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </AppBarElementContainer>
                            <AppBarElementContainer>
                                <muxc:ToggleSplitButton x:Name="myListButton" Grid.Column="2" Grid.ColumnSpan="3" Padding="11,0,11,0">
                                    <muxc:ToggleSplitButton.Content>
                                        <FontIcon Glyph="&#xE133;" />
                                    </muxc:ToggleSplitButton.Content>
                                    <muxc:ToggleSplitButton.Flyout>
                                        <Flyout Placement="Bottom">
                                            <Grid>
                                                <Grid.Resources>
                                                    <Style TargetType="Button">
                                                        <Setter Property="Padding" Value="4"/>
                                                        <Setter Property="MinWidth" Value="0"/>
                                                        <Setter Property="MinHeight" Value="0"/>
                                                        <Setter Property="Margin" Value="6"/>
                                                        <Setter Property="CornerRadius" Value="{StaticResource ControlCornerRadius}"/>
                                                    </Style>
                                                </Grid.Resources>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>

                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <Button x:Name="NoneNumeral" Grid.Row="0" Grid.Column="0" Click="NoneNumeral_Click" Height="48" Width="48">
                                                    <FontIcon FontFamily="{ThemeResource SymbolThemeFontFamily}" Glyph="&#xE738;" />
                                                </Button>
                                                <Button x:Name="DottedNumeral" Grid.Row="0" Grid.Column="1" Click="DottedNumeral_Click" Height="48" Width="48">
                                                    <FontIcon FontFamily="{ThemeResource SymbolThemeFontFamily}" Glyph="&#xE8FD;" />
                                                </Button>
                                                <Button x:Name="NumberNumeral" Grid.Row="0" Grid.Column="2" Click="NumberNumeral_Click" Height="48" Width="48">
                                                    <FontIcon FontFamily="{ThemeResource SymbolThemeFontFamily}" Glyph="&#xF146;" />
                                                </Button>
                                                <Button x:Name="LetterSmallNumeral" Grid.Row="1" Grid.Column="0" Click="LetterSmallNumeral_Click" Height="48" Width="48">
                                                    <TextBlock Text="a" FontSize="24"/>
                                                </Button>
                                                <Button x:Name="LetterBigNumeral"  Grid.Row="1" Grid.Column="1" Click="LetterBigNumeral_Click" Height="48" Width="48">
                                                    <TextBlock Text="A" FontSize="24"/>
                                                </Button>
                                                <Button x:Name="SmalliNumeral" Grid.Row="1" Grid.Column="2" Click="SmalliNumeral_Click" Height="48" Width="48">
                                                    <TextBlock Text="i" FontSize="24"/>
                                                </Button>
                                                <Button x:Name="BigINumeral" Grid.Row="2" Grid.Column="0" Click="BigINumeral_Click" Height="48" Width="48">
                                                    <TextBlock Text="I" FontSize="24"/>
                                                </Button>
                                            </Grid>
                                        </Flyout>
                                    </muxc:ToggleSplitButton.Flyout>
                                </muxc:ToggleSplitButton>
                            </AppBarElementContainer>
                            <AppBarElementContainer>
                                <muxc:SplitButton x:Name="Back2" FontFamily="{ThemeResource SymbolThemeFontFamily}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" FontSize="12" Padding="0,0,5,0" ToolTipService.ToolTip="Text highlight" BorderThickness="0,1,0,1">
                                    <muxc:SplitButton.Flyout>
                                        <Flyout>
                                            <StackPanel>
                                                <Grid >
                                                    <Button Background="DarkRed"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Red"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="50,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="OrangeRed"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="100,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="IndianRed"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="150,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="PaleVioletRed"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="200,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="HotPink"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="250,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Pink"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="300,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LightPink"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="350,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="DarkGreen"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" VerticalAlignment="Top" Margin="0,50,0,0"  Click="HighlightButton_Click"/>
                                                    <Button Background="DarkOliveGreen"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="50,50,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Green"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="100,50,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="ForestGreen"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="150,50,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LimeGreen"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="200,50,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Lime"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="250,50,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="SpringGreen"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="300,50,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="GreenYellow"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="350,50,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="DarkBlue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" VerticalAlignment="Top" Margin="0,100,0,0"  Click="HighlightButton_Click"/>
                                                    <Button Background="DarkSlateBlue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="50,100,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Blue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="100,100,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="CornflowerBlue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="150,100,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="DodgerBlue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="200,100,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="DeepSkyBlue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="250,100,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LightSkyBlue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="300,100,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LightBlue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="350,100,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="DarkOrange"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" VerticalAlignment="Top" Margin="0,150,0,0"  Click="HighlightButton_Click"/>
                                                    <Button Background="Orange"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="50,150,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Yellow"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="100,150,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="AntiqueWhite"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="150,150,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LightGoldenrodYellow"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="200,150,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LightYellow"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="250,150,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="WhiteSmoke"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="300,150,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="FloralWhite"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="350,150,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Black"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" VerticalAlignment="Top" Margin="0,200,0,0"  Click="HighlightButton_Click"/>
                                                    <Button Background="DimGray"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="50,200,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="DarkGray"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="100,200,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Gray"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="150,200,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LightSlateGray"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="200,200,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LightGray"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="250,200,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="White"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="300,200,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Transparent" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="350,200,0,0" VerticalAlignment="Top" Click="NullHighlightButton_Click">
                                                        <Border BorderBrush="Red" BorderThickness="1" Width="39" RenderTransformOrigin="0.5,0.5">
                                                            <Border.RenderTransform>
                                                                <CompositeTransform Rotation="46.118"/>
                                                            </Border.RenderTransform>
                                                        </Border>
                                                    </Button>
                                                </Grid>
                                                <ColorPicker x:Name="BackPicker" ColorChanged="BackPicker_ColorChanged" Color="#00000000" Margin="0,15,0,0"/>
                                            </StackPanel>
                                        </Flyout>
                                    </muxc:SplitButton.Flyout>
                                    <Grid>
                                        <TextBlock x:Name="BackAccent" Text="&#xE891;" Foreground="White"  FontSize="14"/>
                                        <Border Background="#FFFFBB00" Margin="1,1,1,11"/>
                                        <Border Background="#FFFF9800" Margin="2,5,2,8" CornerRadius="0,0,1,1"/>
                                        <TextBlock Text="&#xE193;"  FontSize="14" Foreground="{Binding Foreground, ElementName=BorTextAccent}"/>
                                    </Grid>
                                </muxc:SplitButton>
                            </AppBarElementContainer>
                            <AppBarElementContainer>
                                <muxc:SplitButton
x:Name="TempDDB"
HorizontalContentAlignment="Center"
VerticalContentAlignment="Center"
VerticalAlignment="Top" HorizontalAlignment="Left" CornerRadius="5,5,5,5" ToolTipService.ToolTip="Templates">
                                    <muxc:SplitButton.Flyout>
                                        <Flyout x:Name="TempFlyout">
                                            <Grid>
                                                <Button
                x:Name="Template1"
                Content="Normal&#xA;content" 
                VerticalAlignment="Top"
                Width="100"
                Height="63" 
                Margin="0,0,0,0" 
                Click="Template1_Click" FontSize="11"/>
                                                <Button 
                x:Name="Template2"
                Content="Title" 
                VerticalAlignment="Top" 
                Width="100"
                Height="63"
                Margin="0,63,0,0"
                FontSize="28" 
                FontWeight="Normal" 
                FontStyle="Normal" 
                Click="Template2_Click"/>
                                                <Button
                x:Name="Template3" 
                Content="Title 2" 
                VerticalAlignment="Top"
                Width="100"
                Height="63"
                Margin="0,126,0,0"
                FontSize="22" 
                Click="Template3_Click"/>
                                                <Button 
                x:Name="Template4" 
                Content="Important"
                VerticalAlignment="Top"
                Width="100"
                Height="63"
                Margin="0,189,0,0"
                FontSize="16"
                FontWeight="Bold"
                FontStyle="Italic"
                Click="Template4_Click"/>
                                                <Button
                x:Name="Template5"
                Content="Header" 
                VerticalAlignment="Top"
                Width="100"
                Height="63" 
                Margin="100,0,0,0" 
                Click="Template5_Click" FontSize="14" FontFamily="Segoe UI"/>
                                                <Button 
                x:Name="Template6"
                Content="Medium" 
                VerticalAlignment="Top" 
                Width="100"
                Height="63"
                Margin="100,63,0,0"
                FontSize="18" 
                FontWeight="Normal" 
                FontStyle="Normal" 
                Click="Template6_Click"/>
                                                <Button
                x:Name="Template7" 
                Content="Subtitle" 
                VerticalAlignment="Top"
                Width="100"
                Height="63"
                Margin="100,126,0,0"
                FontSize="20" 
                Click="Template7_Click"/>
                                                <Button 
                x:Name="Template8" 
                Content="Strong"
                VerticalAlignment="Top"
                Width="100"
                Height="63"
                Margin="100,189,0,0"
                FontSize="18"
                FontWeight="Bold"
                FontStyle="Normal"
                Click="Template8_Click"/>
                                                <Button
                x:Name="Template9"
                Content="Content" 
                VerticalAlignment="Top"
                Width="100"
                Height="63" 
                Margin="200,0,0,0" 
                Click="Template9_Click" FontSize="16"/>
                                                <Button 
                x:Name="Template10"
                Content="Finished" 
                VerticalAlignment="Top" 
                Width="100"
                Height="63"
                Margin="200,63,0,0"
                FontSize="14" 
                FontWeight="Normal" 
                FontStyle="Italic" 
                Click="Template10_Click"/>
                                                <Button
                x:Name="Template11" 
                Content="Unfinished" 
                VerticalAlignment="Top"
                Width="100"
                Height="63"
                Margin="200,126,0,0"
                FontSize="14" 
                Click="Template11_Click" FontWeight="Bold"/>
                                                <Button 
                x:Name="Template12" 
                Content="Strong&#xA;header"
                VerticalAlignment="Top"
                Width="100"
                Height="63"
                Margin="200,189,0,0"
                FontSize="18"
                FontWeight="Normal"
                FontStyle="Italic"
                Click="Template10_Click" Foreground="DimGray"/>
                                            </Grid>
                                        </Flyout>
                                    </muxc:SplitButton.Flyout>
                                    <FontIcon Glyph="&#xE185;"/>
                                </muxc:SplitButton>
                            </AppBarElementContainer>

                            <AppBarSeparator />
                            <AppBarButton Style="{StaticResource CrimsonToolbarButton}" ToolTipService.ToolTip="FindDoc" Click="FindButton2_Click">
                                <Button.Content>
                                    <Viewbox MaxWidth="17" MaxHeight="17">
                                        <SymbolIcon Symbol="Find" />
                                    </Viewbox>
                                </Button.Content>
                            </AppBarButton>
                            <AppBarSeparator />
                            <AppBarToggleButton Click="SubscriptButton_Click" Label="Subscript">
                                <AppBarToggleButton.Icon>
                                    <PathIcon Data="M16.488 4.43a.75.75 0 0 1 .082 1.058L10.988 12l5.032 5.871c-.302.41-.555.906-.682 1.51L10 13.151l-5.43 6.336a.75.75 0 0 1-1.14-.976L9.013 12 3.431 5.488a.75.75 0 0 1 1.139-.976L10 10.848l5.43-6.336a.75.75 0 0 1 1.058-.081ZM17.75 15.523c0-.528.444-1.023.986-1.023.407 0 .735.19.893.434.136.21.218.566-.093 1.095-.15.255-.376.482-.682.724-.152.12-.316.237-.493.363l-.074.052c-.152.107-.315.222-.472.34-.744.56-1.565 1.346-1.565 2.742 0 .414.336.75.75.75h3.451a.75.75 0 0 0 0-1.5h-2.513c.16-.282.423-.525.779-.793.137-.103.279-.203.432-.312l.078-.054c.178-.127.37-.264.557-.41.372-.295.76-.658 1.045-1.142.557-.948.546-1.921.058-2.672C20.42 13.4 19.59 13 18.736 13c-1.478 0-2.486 1.278-2.486 2.523a.75.75 0 0 0 1.5 0Z"/>
                                </AppBarToggleButton.Icon>
                            </AppBarToggleButton>
                            <AppBarToggleButton Click="SuperscriptButton_Click" Label="Superscript">
                                <AppBarToggleButton.Icon>
                                    <PathIcon Data="M18.736 3.5c-.543 0-.986.495-.986 1.023a.75.75 0 0 1-1.5 0C16.25 3.278 17.258 2 18.736 2c.855 0 1.684.4 2.15 1.117.49.751.5 1.724-.057 2.672-.285.484-.673.847-1.045 1.141-.187.148-.379.284-.557.41l-.078.056a17.45 17.45 0 0 0-.432.311c-.356.268-.619.511-.78.793h2.514a.75.75 0 0 1 0 1.5H17a.75.75 0 0 1-.75-.75c0-1.396.821-2.182 1.565-2.741.157-.119.32-.234.472-.341l.074-.052c.177-.126.34-.243.493-.363.306-.242.532-.47.682-.724.31-.53.229-.886.093-1.094-.158-.244-.486-.435-.893-.435Z M15.26 4.71c.06.562.385 1.043.847 1.318L10.987 12l5.583 6.512a.75.75 0 1 1-1.14.976L10 13.152l-5.43 6.336a.75.75 0 0 1-1.14-.976L9.013 12 3.431 5.488a.75.75 0 1 1 1.139-.976L10 10.848l5.26-6.137Z"/>
                                </AppBarToggleButton.Icon>
                            </AppBarToggleButton>
                            <AppBarSeparator />
                            <AppBarButton
                    Click="AddImageButton_Click"
                    Style="{StaticResource CrimsonToolbarButton}"
                    ToolTipService.ToolTip="AddImage">
                                <FontIcon FontSize="17" Glyph="&#xE8B9;" />
                            </AppBarButton>
                            <AppBarButton
                    x:Name="AddLinkButton"
                    Style="{StaticResource CrimsonToolbarButton}"
                    ToolTipService.ToolTip="AddHyperlink">
                                <Button.Content>
                                    <FontIcon FontSize="17" Glyph="&#xE71B;" />
                                </Button.Content>
                                <Button.Flyout>
                                    <Flyout Placement="Bottom">
                                        <StackPanel Orientation="Vertical">
                                            <TextBox x:Name="hyperlinkText" PlaceholderText="Link" AllowFocusOnInteraction="True"/>
                                            <Button Margin="0,10,0,0" Click="AddLinkButton_Click">Add hyperlink to selected text</Button>
                                        </StackPanel>
                                    </Flyout>
                                </Button.Flyout>
                            </AppBarButton>
                            <AppBarButton
                    Click="DateInsertionAsync"
                    Style="{StaticResource CrimsonToolbarButton}"
                    ToolTipService.ToolTip="Insert current Date/Time">
                                <FontIcon FontSize="17" Glyph="&#xE163;" />
                            </AppBarButton>
                            <AppBarButton
                    Click="AddTableButton_Click"
                    Style="{StaticResource CrimsonToolbarButton}"
                    ToolTipService.ToolTip="AddTable">
                                <FontIcon FontSize="17" Glyph="&#xF261;" />
                            </AppBarButton>
                            <AppBarButton
                    Click="AddSymbolButton_Click"
                            x:Name="symbolbut"
                    Style="{StaticResource CrimsonToolbarButton}"
                    ToolTipService.ToolTip="AddSymbol">
                                <FontIcon FontSize="17" Glyph="&#xED58;" />
                                <AppBarButton.Flyout>
                                    <Flyout Placement="Bottom" x:Name="symbolsflyout">
                                        <RelativePanel>
                                            <StackPanel>
                                                <VariableSizedWrapGrid
                                    x:Name="symbolGrid"
                                    MaximumRowsOrColumns="4"
                                    Orientation="Horizontal">
                                                    <VariableSizedWrapGrid.Resources>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Background" Value="Transparent"/>
                                                            <Setter Property="BorderThickness" Value="0"/>
                                                            <Setter Property="CornerRadius" Value="4"/>
                                                            <Setter Property="Margin" Value="4"/>
                                                        </Style>
                                                    </VariableSizedWrapGrid.Resources>
                                                    <Button
                                        AutomationProperties.Name="Mutiply"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Multiplication symbol"
                                         Content="×">
                                                    </Button>
                                                    <Button
                                        AutomationProperties.Name="Divide"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Division symbol"
                                                Content="÷">
                                                    </Button>
                                                    <Button
                                        AutomationProperties.Name="LeftArrow"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Left Arrow symbol"
                                                Content="←">
                                                    </Button>
                                                    <Button
                                        AutomationProperties.Name="RightArrow"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Right Arrow symbol"
                                                Content="→">
                                                    </Button>
                                                    <Button
                                        AutomationProperties.Name="Degree"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Degree symbol"
                                                Content="°">
                                                    </Button>
                                                    <Button
                                        AutomationProperties.Name="Paragraph"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Paragraph symbol"
                                                Content="§">
                                                    </Button>
                                                    <Button
                                        AutomationProperties.Name="Mu"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Lowercase mu (micro) symbol"
                                                Content="µ">
                                                    </Button>
                                                    <Button
                                        AutomationProperties.Name="SquareRoot"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Square root symbol"
                                                Content="√">
                                                    </Button>

                                                </VariableSizedWrapGrid>
                                                <Button Content="More symbols" Click="more_symbols" Width="160"/>
                                            </StackPanel>
                                        </RelativePanel>
                                    </Flyout>
                                </AppBarButton.Flyout>
                            </AppBarButton>
                            <AppBarButton
Click="ComputeHash_Click"
Style="{StaticResource CrimsonToolbarButton}"
ToolTipService.ToolTip="Compute Hash">
                                <FontIcon FontSize="17" Glyph="&#xE943;" />
                            </AppBarButton>
                        </controls:TabbedCommandBarItem>
                        <controls:TabbedCommandBarItem Header="Edit" Background="Transparent">
                            <AppBarButton Click="UndoButton_Click" Label="Undo" Icon="Undo" />
                            <AppBarButton Click="RedoButton_Click" Label="Redo" Icon="Redo"/>
                            <AppBarSeparator />
                            <AppBarButton Click="CutButton_Click" Label="Cut" Icon="Cut"/>
                            <AppBarButton Click="CopyButton_Click" Label="Copy" Icon="Copy"/>
                            <AppBarButton Click="PasteButton_Click" Label="Paste" Icon="Paste"/>
                        </controls:TabbedCommandBarItem>
                        <controls:TabbedCommandBarItem x:Name="commentstabitem"
                                               Header="Comments"
                                               IsContextual="True"
                                               Visibility="Collapsed"
                                                        Background="Transparent">
                            <AppBarButton Label="Hide Comments UI" Icon="LeaveChat" Click="closecomments"/>
                        </controls:TabbedCommandBarItem>
                        <controls:TabbedCommandBarItem Header="Help" Background="Transparent">
                            <AppBarButton Label="About" Click="AboutBtn_Click">
                                <AppBarButton.Icon>
                                    <SymbolIcon Symbol="Help"/>
                                </AppBarButton.Icon>
                            </AppBarButton>
                            <AppBarButton Label="utever" Icon="Help" Click="uteverclick">
                            </AppBarButton>
                            <AppBarSeparator/>
                            <AppBarButton Label="First Run Dialog" Icon="Help" Click="fr_invoke"/>
                            <AppBarButton Label="What's New Dialog" Icon="Help" Click="WN_invoke"/>
                        </controls:TabbedCommandBarItem>
                    </controls:TabbedCommandBar.MenuItems>
                </controls:TabbedCommandBar>
                <RelativePanel x:Name="Ribbon" RelativePanel.Below="ButtonPanel" Padding="8" Height="170" RelativePanel.AlignLeftWithPanel="True" RelativePanel.AlignRightWithPanel="True">
                    <Grid x:Name="TopMid" CornerRadius="8" HorizontalAlignment="Left" RelativePanel.AlignLeftWithPanel="True" RelativePanel.AlignRightWithPanel="True">
                        <RelativePanel>
                            <StackPanel x:Name="RibbonTabs" Orientation="Horizontal" RelativePanel.AlignLeftWithPanel="True" RelativePanel.AlignRightWithPanel="True" RelativePanel.AlignTopWithPanel="True">
                                <ToggleButton x:Name="EditButton" Content="Home" Background="#00000000" BorderBrush="{x:Null}" BorderThickness="0,0,0,0" Height="32" Click="Button_Click_33" Style="{StaticResource CrimsonToolbarToggleButton}" Padding="11,6,11,4"/>
                                <ToggleButton x:Name="InsertButton" Content="Insert" Background="#00000000" BorderBrush="{x:Null}" BorderThickness="0,0,0,0" Height="32" Click="Button_Click_34" Style="{StaticResource CrimsonToolbarToggleButton}" Padding="11,6,11,4"/>
                                <ToggleButton x:Name="CommentsButton" Content="Comments" Background="#00000000" BorderBrush="{x:Null}" BorderThickness="0,0,0,0" Height="32" Click="Button_Click_37" Style="{StaticResource CrimsonToolbarContextualToggleButton}" Padding="11,6,11,4"/>

                                <ToggleButton x:Name="DeveloperButton" Content="Developer" Background="#00000000" BorderBrush="{x:Null}" BorderThickness="0,0,0,0" Height="32" Click="Button_Click_36" Style="{StaticResource CrimsonToolbarToggleButton}" Padding="11,6,11,4"/>
                                <ToggleButton x:Name="HelpButton" Content="Help" Background="#00000000" BorderBrush="{x:Null}" BorderThickness="0,0,0,0" Height="32" Click="Button_Click_35" Style="{StaticResource CrimsonToolbarToggleButton}" Padding="11,6,11,4"/>
                            </StackPanel>
                            <Border x:Name="RibbonBorder" RelativePanel.Below="RibbonTabs" VerticalAlignment="Top" BorderBrush="{StaticResource CardStrokeColorDefaultBrush}" BorderThickness="0,1,0,1" Height="160" HorizontalAlignment="Stretch" Background="{StaticResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" RelativePanel.AlignLeftWithPanel="True" RelativePanel.AlignRightWithPanel="True">
                                <Grid>
                                    <Grid x:Name="Home" VerticalAlignment="Top" Height="140" HorizontalAlignment="Stretch" CornerRadius="8" RelativePanel.AlignLeftWithPanel="True" RelativePanel.AlignRightWithPanel="True">
                                        <RelativePanel>
                                            <Grid x:Name="Font" VerticalAlignment="Top" Height="128" Margin="10,2,0,0" CornerRadius="8">
                                                <Border x:Name="FontBor" BorderThickness="1" VerticalAlignment="Top" Margin="0,42,0,0" Height="27" HorizontalAlignment="Left" CornerRadius="4,4,4,4" Visibility="Collapsed"/>
                                                <StackPanel HorizontalAlignment="Left" VerticalAlignment="Top" Orientation="Horizontal" Margin="0,7,0,0">
                                                    <ComboBox x:Name="FontBox" Width="255" Height="33" SelectionChanged="FontBox_SelectionChanged" ItemsSource="{x:Bind fonts}" Padding="10,2,2,2" FontSize="14" HorizontalContentAlignment="Left" ToolTipService.ToolTip="Font type" PlaceholderText="Segoe UI (Default)"/>
                                                    <muxc:NumberBox MinWidth="0" x:Name="FSize" Width="147" ValueChanged="NumberBox_ValueChanged" VerticalContentAlignment="Center" FontSize="14" ToolTipService.ToolTip="Font size" VerticalAlignment="Top" Margin="6,0,0,0" Height="33" PlaceholderText="Multiple"/>
                                                    <muxc:DropDownButton Width="32" Height="20" HorizontalContentAlignment="Left" FontSize="10" ToolTipService.ToolTip="Font size options" FontFamily="{StaticResource SymbolThemeFontFamily}" VerticalAlignment="Center" Padding="0,0,9,0" CornerRadius="4,4,4,4" Margin="-38,0,0,0" Background="Transparent" BorderBrush="{x:Null}">
                                                        <muxc:DropDownButton.Flyout>
                                                            <MenuFlyout>
                                                                <MenuFlyoutItem Text="8" />
                                                                <MenuFlyoutItem Text="9" />
                                                                <MenuFlyoutItem Text="10" />
                                                                <MenuFlyoutItem Text="10.5" />
                                                                <MenuFlyoutItem Text="11" />
                                                                <MenuFlyoutItem Text="12" />
                                                                <MenuFlyoutItem Text="14" />
                                                                <MenuFlyoutItem Text="16" />
                                                                <MenuFlyoutItem Text="18" />
                                                                <MenuFlyoutItem Text="20" />
                                                                <MenuFlyoutItem Text="22" />
                                                                <MenuFlyoutItem Text="24" />
                                                                <MenuFlyoutItem Text="26" />
                                                                <MenuFlyoutItem Text="28" />
                                                                <MenuFlyoutItem Text="36" />
                                                                <MenuFlyoutItem Text="48" />
                                                                <MenuFlyoutItem Text="72" />
                                                                <MenuFlyoutSeparator/>
                                                                <MenuFlyoutItem Text="Default" />
                                                            </MenuFlyout>
                                                        </muxc:DropDownButton.Flyout>
                                                    </muxc:DropDownButton>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,50,0,0" Spacing="3">
                                                    <ToggleButton Style="{StaticResource CrimsonToolbarToggleButton}" x:Name="BB" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Content="&#xE19B;" Width="30" Height="30" Click="BoldButton_Click" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="16" Padding="2,3,2,2" ToolTipService.ToolTip="Bold (Ctrl + B)" CornerRadius="4,4,4,4" Background="{x:Null}" BorderBrush="{x:Null}"/>
                                                    <ToggleButton x:Name="IB" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Content="&#xE199;" Width="30" Height="30" Click="ItalicButton_Click" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="16" ToolTipService.ToolTip="Italic (Ctrl + I)" CornerRadius="4,4,4,4" Padding="5,5,5,5" Style="{StaticResource CrimsonToolbarToggleButton}" Background="{x:Null}" BorderBrush="{x:Null}"/>
                                                    <muxc:DropDownButton x:Name="UB" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Width="50" Height="30" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="14" ToolTipService.ToolTip="Underline (Ctrl + U)" Background="{x:Null}" BorderBrush="{x:Null}" CornerRadius="4,4,4,4" Padding="5,5,5,6">
                                                        <Grid>
                                                            <TextBlock TextWrapping="Wrap" Text="&#xE19A;" FontFamily="{StaticResource SymbolThemeFontFamily}" HorizontalAlignment="Left" VerticalAlignment="Center" FontSize="16"/>
                                                        </Grid>
                                                        <muxc:DropDownButton.Flyout>
                                                            <MenuFlyout x:Name="UnderlineFlyout">
                                                                <MenuFlyoutItem Text="None" Click="MenuFlyoutItem_Click">
                                                                    <MenuFlyoutItem.Icon>
                                                                        <FontIcon FontFamily="{StaticResource SymbolThemeFontFamily}" Glyph="&#xE106;"/>
                                                                    </MenuFlyoutItem.Icon>
                                                                </MenuFlyoutItem>
                                                                <MenuFlyoutItem Text="Single" Click="MenuFlyoutItem_Click">
                                                                    <MenuFlyoutItem.Icon>
                                                                        <FontIcon FontFamily="{StaticResource SymbolThemeFontFamily}" Glyph="&#xE004;"/>
                                                                    </MenuFlyoutItem.Icon>
                                                                    <MenuFlyoutItem.KeyboardAccelerators>
                                                                        <KeyboardAccelerator IsEnabled="False" Modifiers="Control" Key="U"/>
                                                                    </MenuFlyoutItem.KeyboardAccelerators>
                                                                </MenuFlyoutItem>
                                                                <MenuFlyoutItem Text="Dash" Click="MenuFlyoutItem_Click">
                                                                    <MenuFlyoutItem.Icon>
                                                                        <FontIcon FontFamily="{StaticResource SymbolThemeFontFamily}" Glyph="&#xE004;&#xE004;"/>
                                                                    </MenuFlyoutItem.Icon>
                                                                </MenuFlyoutItem>
                                                                <MenuFlyoutItem Text="Dotted" Click="MenuFlyoutItem_Click">
                                                                    <MenuFlyoutItem.Icon>
                                                                        <FontIcon FontFamily="{StaticResource SymbolThemeFontFamily}" Glyph="&#xE10C;"/>
                                                                    </MenuFlyoutItem.Icon>
                                                                </MenuFlyoutItem>
                                                                <MenuFlyoutItem Text="Double" Click="MenuFlyoutItem_Click">
                                                                    <MenuFlyoutItem.Icon>
                                                                        <FontIcon FontFamily="{StaticResource SymbolThemeFontFamily}" Glyph="&#xE94E;"/>
                                                                    </MenuFlyoutItem.Icon>
                                                                </MenuFlyoutItem>
                                                                <MenuFlyoutItem Text="Thick" Click="MenuFlyoutItem_Click">
                                                                    <MenuFlyoutItem.Icon>
                                                                        <FontIcon FontFamily="{StaticResource SymbolThemeFontFamily}" Glyph="&#xE654;"/>
                                                                    </MenuFlyoutItem.Icon>
                                                                </MenuFlyoutItem>
                                                                <MenuFlyoutItem Text="Wave" Click="MenuFlyoutItem_Click">
                                                                    <MenuFlyoutItem.Icon>
                                                                        <FontIcon FontFamily="{StaticResource SymbolThemeFontFamily}" Glyph="&#xF463;"/>
                                                                    </MenuFlyoutItem.Icon>
                                                                </MenuFlyoutItem>
                                                            </MenuFlyout>
                                                        </muxc:DropDownButton.Flyout>
                                                    </muxc:DropDownButton>
                                                    <ToggleButton x:Name="STB" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Width="30" Height="30" Click="StrikethroughButton_Click" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="10" Padding="2,2,2,2" ToolTipService.ToolTip="Strikethrough (Ctrl + T)" CornerRadius="4,4,4,4" Style="{StaticResource CrimsonToolbarToggleButton}" Background="{x:Null}" BorderBrush="{x:Null}">
                                                        <ToggleButton.KeyboardAccelerators>
                                                            <KeyboardAccelerator IsEnabled="True" Key="T" Modifiers="Control"/>
                                                        </ToggleButton.KeyboardAccelerators>
                                                        <Grid Width="15" Height="15" Margin="-2,-2,-1,-1">
                                                            <TextBlock TextWrapping="Wrap" Text="&#xEDE0;" FontFamily="{StaticResource SymbolThemeFontFamily}" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="16"/>
                                                        </Grid>
                                                    </ToggleButton>
                                                    <ToggleButton x:Name="SubscriptButton" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Width="30" Height="30" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="10" Padding="0,0,2,2" ToolTipService.ToolTip="Subscript" Click="SubscriptButton_Click" CornerRadius="4,4,4,4" Style="{StaticResource CrimsonToolbarToggleButton}" Background="{x:Null}" BorderBrush="{x:Null}">
                                                        <Grid Width="20" Height="20" Margin="0,2,0,0">
                                                            <TextBlock Text="&#xE8BB;" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="9" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="3,0,0,0"/>
                                                            <TextBlock FontSize="6" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="0,0,0,2" Text="(1)" Foreground="{ThemeResource SystemAccentColor}" FontWeight="Bold" FontFamily="Segoe UI"/>
                                                        </Grid>
                                                    </ToggleButton>
                                                    <ToggleButton x:Name="SuperscriptButton" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Width="30" Height="30" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="10" Padding="0,0,2,2" ToolTipService.ToolTip="Superscript" Click="SuperscriptButton_Click" CornerRadius="4,4,4,4" Style="{StaticResource CrimsonToolbarToggleButton}" Background="{x:Null}" BorderBrush="{x:Null}">
                                                        <Grid Width="20" Height="20" Margin="0,2,0,0">
                                                            <TextBlock FontSize="6" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,-1,0,0" Text="(1)" Foreground="{ThemeResource SystemAccentColor}" FontWeight="Bold" FontFamily="Segoe UI"/>
                                                            <TextBlock Text="&#xE8BB;" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="9" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="3,0,0,0"/>
                                                        </Grid>
                                                    </ToggleButton>
                                                    <muxc:DropDownButton x:Name="CPDDB" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Height="30" FontSize="12" Width="50" FontFamily="{StaticResource SymbolThemeFontFamily}" ToolTipService.ToolTip="Font color" Background="{x:Null}" BorderBrush="{x:Null}" CornerRadius="4,4,4,4" Padding="5,5,5,6">
                                                        <muxc:DropDownButton.Flyout>
                                                            <Flyout>
                                                                <StackPanel>
                                                                    <Grid>
                                                                        <StackPanel HorizontalAlignment="Left" VerticalAlignment="Top" Spacing="8">
                                                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                                                <Button Background="Red"  Click="ColorButton2_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"   BorderBrush="{x:Null}"/>
                                                                                <Button Background="OrangeRed"  Click="ColorButton2_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="DarkOrange"  Click="ColorButton2_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="Yellow"  Click="ColorButton2_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                            </StackPanel>
                                                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                                                <Button Background="HotPink"  Click="ColorButton2_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="LimeGreen"  Click="ColorButton2_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="Lime"  Click="ColorButton2_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="DodgerBlue"  Click="ColorButton2_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                            </StackPanel>
                                                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                                                <Button Background="Blue"  Click="ColorButton2_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="Black"  Click="ColorButton2_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="DarkGray"  Click="ColorButton2_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="Transparent" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0" Click="NullBackgroundButton_Click" BorderBrush="{x:Null}" >
                                                                                    <Border BorderBrush="Red" BorderThickness="1" Width="39" RenderTransformOrigin="0.5,0.5">
                                                                                        <Border.RenderTransform>
                                                                                            <CompositeTransform Rotation="46.118"/>
                                                                                        </Border.RenderTransform>
                                                                                    </Border>
                                                                                </Button>
                                                                            </StackPanel>
                                                                            <Button Content="Advanced" HorizontalAlignment="Stretch" Margin="0,5,0,0" Click="Button_Click_32"/>
                                                                        </StackPanel>
                                                                    </Grid>
                                                                </StackPanel>
                                                            </Flyout>
                                                        </muxc:DropDownButton.Flyout>
                                                        <Grid>
                                                            <TextBlock TextWrapping="Wrap" Text="&#xE186;" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="16"/>
                                                        </Grid>
                                                    </muxc:DropDownButton>
                                                    <muxc:DropDownButton x:Name="Back" Height="30" FontSize="12" Width="50" FontFamily="{StaticResource SymbolThemeFontFamily}" ToolTipService.ToolTip="Text highlight" Background="{x:Null}" BorderBrush="{x:Null}" CornerRadius="4,4,4,4" Padding="5,5,5,6">
                                                        <muxc:DropDownButton.Flyout>
                                                            <Flyout>
                                                                <StackPanel>
                                                                    <Grid>
                                                                        <StackPanel HorizontalAlignment="Left" VerticalAlignment="Top" Spacing="8">
                                                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                                                <Button Background="Red"  Click="HighlightButton_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"   BorderBrush="{x:Null}"/>
                                                                                <Button Background="OrangeRed"  Click="HighlightButton_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="DarkOrange"  Click="HighlightButton_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="Yellow"  Click="HighlightButton_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                            </StackPanel>
                                                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                                                <Button Background="HotPink"  Click="HighlightButton_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="LimeGreen"  Click="HighlightButton_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="Lime"  Click="HighlightButton_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="DodgerBlue"  Click="HighlightButton_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                            </StackPanel>
                                                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                                                <Button Background="Blue"  Click="HighlightButton_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="Black"  Click="HighlightButton_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="DarkGray"  Click="HighlightButton_Click" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0"    BorderBrush="{x:Null}"/>
                                                                                <Button Background="Transparent" Width="39" Height="39" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="36" Padding="0,0,0,0" Click="NullBackgroundButton_Click" BorderBrush="{x:Null}" >
                                                                                    <Border BorderBrush="Red" BorderThickness="1" Width="39" RenderTransformOrigin="0.5,0.5">
                                                                                        <Border.RenderTransform>
                                                                                            <CompositeTransform Rotation="46.118"/>
                                                                                        </Border.RenderTransform>
                                                                                    </Border>
                                                                                </Button>
                                                                            </StackPanel>
                                                                            <Button Content="Advanced" HorizontalAlignment="Stretch" Margin="0,5,0,0" Click="Button_Click_32"/>
                                                                        </StackPanel>
                                                                    </Grid>
                                                                </StackPanel>
                                                            </Flyout>
                                                        </muxc:DropDownButton.Flyout>
                                                        <Grid
                                   >
                                                            <TextBlock x:Name="BackAccent2" Text="&#xE891;" Foreground="White" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="16"/>
                                                            <TextBlock Text="&#xE193;" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="16"/>
                                                        </Grid>
                                                    </muxc:DropDownButton>
                                                </StackPanel>
                                                <Grid x:Name="TempViewer" Margin="415,7,12,0">
                                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Top" Background="{StaticResource ControlFillColorDefaultBrush}" BorderBrush="{Binding BorderBrush, ElementName=FontBox}" BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" Height="72">

                                                        <Button
                                                            x:Name="HTemplate1"
                                                            Content="Normal"
                                                            VerticalAlignment="Top"
                                                            Width="80"
                                                            Height="60" 
                                                            Click="Template1_Click" FontSize="11" Margin="5,5,0,0" RequestedTheme="Light" Background="White"/>
                                                        <Button 
                                                            x:Name="HTemplate2"
                                                            Content="Title" 
                                                            VerticalAlignment="Top" 
                                                            Width="80"
                                                            Height="60"
                                                            FontSize="28" 
                                                            FontWeight="Normal" 
                                                            FontStyle="Normal" 
                                                            Click="Template2_Click" Margin="4,5,0,0" Background="White" RequestedTheme="Light"/>
                                                        <Button
                                                            x:Name="HTemplate9"
                                                            Content="Content" 
                                                            VerticalAlignment="Top"
                                                            Width="80"
                                                            Height="60" 
                                                            Click="Template9_Click" FontSize="16" Margin="5,5,0,0" Background="White" RequestedTheme="Light"/>
                                                    </StackPanel>
                                                    <DropDownButton x:Name="DDTempViewer" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Width="24" FontSize="12" ToolTipService.ToolTip="Show all" VerticalAlignment="Top" Margin="263,24,9,0" Height="24" FontWeight="Bold" Padding="-1,0,4,0" CornerRadius="4,4,4,4" Background="{x:Null}" BorderBrush="{x:Null}">
                                                        <DropDownButton.Flyout>
                                                            <Flyout>
                                                                <Grid VerticalAlignment="Top" BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" HorizontalAlignment="Left" Margin="0,0,3,0">

                                                                    <Button
                x:Name="HTemplate3"
                Content="Normal" 
                VerticalAlignment="Top"
                Width="80"
                Height="60" 
                Click="Template1_Click" FontSize="11" Margin="5,5,0,0" RequestedTheme="Light" Background="White"/>
                                                                    <Button 
                x:Name="HTemplate4"
                Content="Title" 
                VerticalAlignment="Top" 
                Width="80"
                Height="60"
                FontSize="28" 
                FontWeight="Normal" 
                FontStyle="Normal" 
                Click="Template2_Click" Margin="89,5,0,0" Background="White" RequestedTheme="Light"/>
                                                                    <Button
                x:Name="HTemplate5"
                Content="Content" 
                VerticalAlignment="Top"
                Width="80"
                Height="60" 
                Click="Template9_Click" FontSize="16" Margin="174,5,0,0" Background="White" RequestedTheme="Light"/>
                                                                    <Grid>
                                                                        <Button
                    x:Name="PTemplate3" 
                    Content="Title 2" 
                    VerticalAlignment="Top"
                    Width="80"
                    Height="60"
                    Margin="89,70,0,0"
                    FontSize="22" 
                    Click="Template3_Click" Padding="0,5,0,6" RequestedTheme="Light" Background="White"/>
                                                                        <Button 
                    x:Name="PTemplate4" 
                    Content="Book&#xA;title"                                                        
                    VerticalAlignment="Top"
                    Width="80"
                    Height="60"
                    Margin="5,201,0,0"
                    FontSize="16"
                    FontWeight="Bold"
                    FontStyle="Italic"
                    Click="Template4_Click" RequestedTheme="Light" Background="White"/>
                                                                        <Button
                    x:Name="PTemplate5"
                    Content="Header" 
                    VerticalAlignment="Top"
                    Width="80"
                    Height="60" 
                    Margin="5,70,0,0" 
                    Click="Template5_Click" FontSize="14" FontFamily="Segoe UI" RequestedTheme="Light" Background="White"/>
                                                                        <Button 
                    x:Name="PTemplate6"
                    Content="Medium" 
                    VerticalAlignment="Top" 
                    Width="80"
                    Height="60"
                    Margin="174,70,0,0"
                    FontSize="18" 
                    FontWeight="Normal" 
                    FontStyle="Normal" 
                    Click="Template6_Click" Padding="0,5,0,6" RequestedTheme="Light" Background="White"/>
                                                                        <Button
                    x:Name="PTemplate7" 
                    Content="Subtitle" 
                    VerticalAlignment="Top"
                    Width="80"
                    Height="60"
                    Margin="89,135,0,0"
                    FontSize="20" 
                    Click="Template7_Click" Padding="0,5,0,6" RequestedTheme="Light" Background="White"/>
                                                                        <Button 
                    x:Name="PTemplate8" 
                    Content="Strong"
                    VerticalAlignment="Top"
                    Width="80"
                    Height="60"
                    Margin="89,201,0,0"
                    FontSize="18"
                    FontWeight="Bold"
                    FontStyle="Normal"
                    Click="Template8_Click" RequestedTheme="Light" Background="White"/>
                                                                        <Button 
                    x:Name="PTemplate10"
                    Content="Finished" 
                    VerticalAlignment="Top" 
                    Width="80"
                    Height="60"
                    Margin="5,135,0,0"
                    FontSize="14" 
                    FontWeight="Normal" 
                    FontStyle="Italic" 
                    Click="Template10_Click" RequestedTheme="Light" Background="White"/>
                                                                        <Button
                    x:Name="PTemplate11" 
                    Content="Unfinished" 
                    VerticalAlignment="Top"
                    Width="80"
                    Height="60"
                    Margin="174,135,0,0"
                    FontSize="14" 
                    Click="Template11_Click" FontWeight="Bold" Padding="0,5,0,6" RequestedTheme="Light" Background="White"/>
                                                                        <Button 
                    x:Name="PTemplate12" 
                    Content="Quote"
                    VerticalAlignment="Top"
                    Width="80"
                    Height="60"
                    Margin="174,201,0,0"
                    FontSize="18"
                    FontWeight="Normal"
                    FontStyle="Italic"
                    Click="Template12_Click" Foreground="DimGray" RequestedTheme="Light" Background="White"/>
                                                                    </Grid>
                                                                </Grid>

                                                            </Flyout>
                                                        </DropDownButton.Flyout>
                                                    </DropDownButton>
                                                </Grid>
                                                <Border BorderThickness="1" Width="3" HorizontalAlignment="Right" Background="#7F989898" Height="{Binding Height, ElementName=Separator}" VerticalAlignment="Top" CornerRadius="1,1,1,1" Opacity="{Binding Opacity, ElementName=Separator}"/>
                                                <TextBlock x:Name="HI5" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="12" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,77,0,0" Text="&#xE11B;" Tag="HelpItem" ToolTipService.ToolTip="Change anything about how your text looks by modifying the font and paragraph options" Visibility="Collapsed"/>
                                                <TextBlock Text="Font" TextWrapping="Wrap" HorizontalAlignment="Center" FontSize="12" VerticalAlignment="Bottom" Opacity="0.8" Margin="0,0,0,18"/>
                                                <Border BorderThickness="1" Width="3" HorizontalAlignment="Right" Background="{StaticResource DividerStrokeColorDefaultBrush}" CornerRadius="1,1,1,1" Margin="0,-2,0,0"/>
                                            </Grid>
                                            <Grid x:Name="Paragraph" Height="128" RelativePanel.RightOf="Font" Margin="10,2,0,0" Width="Auto">
                                                <TextBlock x:Name="HI6" FontSize="12" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,77,0,0" Text="&#xE11B;" Tag="HelpItem" ToolTipService.ToolTip="Insert hyperlinks, images and the current date and time in different formats" Visibility="Collapsed"/>
                                                <StackPanel Margin="0,49,0,0" Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Top" Spacing="5">
                                                    <Button x:Name="LeftAl" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Content="&#xE1A2;" Width="30" Height="30" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="16" Padding="2,2,2,2" ToolTipService.ToolTip="Left" BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" VerticalAlignment="Top" Click="AlignLeftButton_Click" Background="Transparent" BorderBrush="#00000000" Style="{StaticResource CrimsonToolbarButton}"/>
                                                    <Button x:Name="CenterAl" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Content="&#xE1A1;" Width="30" Height="30" Click="AlignCenterButton_Click" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="16" Padding="2,2,2,2" ToolTipService.ToolTip="Center" BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" VerticalAlignment="Top" Background="Transparent" BorderBrush="#00000000" Style="{StaticResource CrimsonToolbarButton}"/>
                                                    <Button x:Name="RightAl" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Content="&#xE1A0;" Width="30" Height="30" Click="AlignRightButton_Click" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="16" Padding="2,2,2,2" ToolTipService.ToolTip="Right" BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" VerticalAlignment="Top" Background="Transparent" BorderBrush="#00000000" Style="{StaticResource CrimsonToolbarButton}"/>
                                                    <Button x:Name="JustifyAl" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Width="30" Height="30" Click="AlignJustifyButton_Click" Padding="2,2,2,2" ToolTipService.ToolTip="Justify" BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" VerticalAlignment="Top" Background="Transparent" BorderBrush="#00000000" Style="{StaticResource CrimsonToolbarButton}">
                                                        <Button.Content>
                                                            <Viewbox MaxWidth="16" MaxHeight="16">
                                                                <PathIcon Data="M2 6a1 1 0 0 1 1-1h18a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1ZM2 18a1 1 0 0 1 1-1h18a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1ZM3 11a1 1 0 1 0 0 2h18a1 1 0 1 0 0-2H3Z"/>
                                                            </Viewbox>
                                                        </Button.Content>
                                                    </Button>
                                                </StackPanel>
                                                <DropDownButton x:Name="ListBox" Width="65" Height="30" HorizontalContentAlignment="Left" FontSize="14" ToolTipService.ToolTip="List" FontFamily="{StaticResource SymbolThemeFontFamily}" VerticalAlignment="Top" CornerRadius="4,4,4,4" Margin="0,7,0,0" Background="Transparent" BorderBrush="#00000000">
                                                    <DropDownButton.Flyout>
                                                        <MenuFlyout>
                                                            <MenuFlyoutItem Text="None" Click="MenuFlyoutItem_Click_1">
                                                                <MenuFlyoutItem.Icon>
                                                                    <FontIcon  Glyph="&#xE106;"/>
                                                                </MenuFlyoutItem.Icon>
                                                            </MenuFlyoutItem>
                                                            <MenuFlyoutItem Text="Bullet" Click="MenuFlyoutItem_Click_1">
                                                                <MenuFlyoutItem.Icon>
                                                                    <FontIcon  Glyph="&#xE1D2;"/>
                                                                </MenuFlyoutItem.Icon>
                                                            </MenuFlyoutItem>
                                                            <MenuFlyoutItem Text="Numbered" Click="MenuFlyoutItem_Click_1">
                                                                <MenuFlyoutItem.Icon>
                                                                    <FontIcon Glyph="1)" FontFamily="Segoe UI"/>
                                                                </MenuFlyoutItem.Icon>
                                                            </MenuFlyoutItem>
                                                            <MenuFlyoutItem Text="Lowercase" Click="MenuFlyoutItem_Click_1">
                                                                <MenuFlyoutItem.Icon>
                                                                    <FontIcon Glyph="a)" FontFamily="Segoe UI"/>
                                                                </MenuFlyoutItem.Icon>
                                                            </MenuFlyoutItem>
                                                            <MenuFlyoutItem Text="Uppercase" Click="MenuFlyoutItem_Click_1">
                                                                <MenuFlyoutItem.Icon>
                                                                    <FontIcon Glyph="A)" FontFamily="Segoe UI"/>
                                                                </MenuFlyoutItem.Icon>
                                                            </MenuFlyoutItem>
                                                            <MenuFlyoutItem Text="Roman numerals" Click="MenuFlyoutItem_Click_1">
                                                                <MenuFlyoutItem.Icon>
                                                                    <FontIcon Glyph="IV" FontFamily="Segoe UI"/>
                                                                </MenuFlyoutItem.Icon>
                                                            </MenuFlyoutItem>
                                                        </MenuFlyout>
                                                    </DropDownButton.Flyout>
                                                    <Grid>
                                                        <FontIcon Glyph="&#xE15C;" FontSize="16"/>
                                                    </Grid>
                                                </DropDownButton>
                                                <TextBlock Text="Paragraph" TextWrapping="Wrap" HorizontalAlignment="Center" FontSize="12" VerticalAlignment="Bottom" Opacity="0.8" Margin="0,0,4,12"/>

                                            </Grid>
                                        </RelativePanel>
                                    </Grid>
                                    <Grid x:Name="Insert" Height="132" RelativePanel.AlignLeftWithPanel="True" RelativePanel.AlignRightWithPanel="True">
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="20,27,0,0" Spacing="10">
                                            <Button Style="{StaticResource CrimsonToolbarButton}" x:Name="Image_Insert" FontFamily="{StaticResource SymbolThemeFontFamily}" Width="40" Height="53" FontSize="22" Click="AddImageButton_Click" ToolTipService.ToolTip="Insert image" CornerRadius="4,4,4,4" VerticalAlignment="Center" Padding="0,0,0,0" Background="Transparent" BorderBrush="{x:Null}">
                                                <Grid Height="48" Margin="0,-3,0,0">
                                                    <Grid Height="55" HorizontalAlignment="Center" VerticalAlignment="Top" Width="55" RenderTransformOrigin="0.5,0.5" Margin="0,-14,2,0">
                                                        <Grid.RenderTransform>
                                                            <CompositeTransform ScaleX="0.5" ScaleY="0.5"/>
                                                        </Grid.RenderTransform>
                                                        <TextBlock TextWrapping="Wrap" Text="&#xE91B;" FontFamily="{StaticResource SymbolThemeFontFamily}" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="30"/>
                                                        <Border Background="{Binding Foreground, ElementName=LeftInd}" VerticalAlignment="Bottom" HorizontalAlignment="Right" Width="2" Height="18" Margin="0,0,11,19" CornerRadius="0,2,0,0"/>
                                                        <Border Background="{Binding Foreground, ElementName=LeftInd}" VerticalAlignment="Bottom" HorizontalAlignment="Right" Width="18" Height="2" Margin="0,0,17,13" CornerRadius="0,0,0,2"/>
                                                        <Border VerticalAlignment="Bottom" HorizontalAlignment="Right" Width="6" Height="6" Margin="0,0,11,13" CornerRadius="0,0,15,0" BorderBrush="{Binding Foreground, ElementName=LeftInd}" BorderThickness="0,0,2,2"/>
                                                    </Grid>
                                                    <TextBlock FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Bottom" TextAlignment="Center" Margin="0,0,0,1"><Run Text="Insert"/><LineBreak/><Run Text="Image"/></TextBlock>
                                                </Grid>
                                            </Button>
                                            <Button x:Name="LinkInsert" Style="{StaticResource CrimsonToolbarButton}" FontFamily="{StaticResource SymbolThemeFontFamily}" Width="40" Height="53" FontSize="22" ToolTipService.ToolTip="Insert hyperlink" Padding="0,0,0,0" Margin="0,1,0,0" Background="Transparent" BorderBrush="#00000000" CornerRadius="4,4,4,4">
                                                <Button.Flyout>
                                                    <Flyout Placement="Bottom">
                                                        <StackPanel Orientation="Vertical">
                                                            <TextBox x:Name="hyperlinkText2" PlaceholderText="Link" AllowFocusOnInteraction="True"/>
                                                            <Button Margin="0,10,0,0" Click="AddLinkButton2_Click">Add hyperlink to selected text</Button>
                                                        </StackPanel>
                                                    </Flyout>
                                                </Button.Flyout>
                                                <Grid Width="30" Height="45" Margin="4,1,4,-1">
                                                    <TextBlock TextWrapping="Wrap" Text="&#xE167;" FontFamily="{StaticResource SymbolThemeFontFamily}" HorizontalAlignment="Center" VerticalAlignment="Top" FontSize="16"/>
                                                    <TextBlock FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Top" TextAlignment="Center" Margin="0,20,0,0" Width="30"><Run Text="Insert"/><LineBreak/><Run Text="Link"/></TextBlock>
                                                </Grid>
                                            </Button>
                                            <Button x:Name="DateTimeInsert" Style="{StaticResource CrimsonToolbarButton}" FontFamily="{StaticResource SymbolThemeFontFamily}" Click="DateInsertionAsync" Width="40" Height="53" FontSize="22" ToolTipService.ToolTip="Insert date and time" Padding="0,0,0,0" Margin="0,1,0,0" CornerRadius="4,4,4,4" Background="{x:Null}" BorderBrush="{x:Null}">
                                                <Grid Width="30" Height="45" Margin="4,1,4,-1">
                                                    <TextBlock FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Top" TextAlignment="Center" Margin="0,20,0,0" Width="32"><Run Text="Date &amp;"/><LineBreak/><Run Text="Time"/></TextBlock>
                                                    <PathIcon Data="M 3 5 C 3 4 4 3 5 3 L 15 3 C 16 3 17 4 17 5 L 17 12 L 16 12 L 16 5 C 16 4.5 15.5 4 15 4 L 5 4 C 4.5 4 4 4.5 4 5 L 4 15 C 4 15.5 4.5 16 5 16 L 12 16 L 12 17 L 5 17 C 4 17 3 16 3 15 M 16.5 13 A 1 1 0 0 0 16.5 20 A 1 1 0 0 0 16.5 13 M 16.5 14 A 1 1 0 0 1 16.5 19 A 1 1 0 0 1 16.5 14 M 17 17 C 16 17 16 17 16 16 L 16 15.5 C 16 14.5 17 14.5 17 15.5 L 17 16 L 17.5 16 C 18.5 16 18.5 17 17.5 17 L 17 17 M 6 7 A 1 1 0 0 0 6 5 A 1 1 0 0 0 6 7 M 10 7 A 1 1 0 0 0 10 5 A 1 1 0 0 0 10 7 M 14 7 A 1 1 0 0 0 14 5 A 1 1 0 0 0 14 7 M 5 8 L 15 8 L 15 9 L 5 9 M 5 10 L 9 10 L 9 11 L 5 11 M 11 10 L 15 10 L 15 11 L 11 11 M 5 12 L 9 12 L 9 13 L 5 13 M 11 12 L 15 12 C 14.18 12.008 13.393 12.538 13 13 L 11 13 M 5 14 L 9 14 L 9 15 L 5 15 M 11 14 L 12.434 14.001 C 12.062 14.47 12 15 12 15 L 11 15" RenderTransformOrigin="0.5,0.5" HorizontalAlignment="Center" VerticalAlignment="Top" />
                                                    <PathIcon Data="M 3 5 M 16.5 13 A 1 1 0 0 0 16.5 20 A 1 1 0 0 0 16.5 13 M 16.5 14 A 1 1 0 0 1 16.5 19 A 1 1 0 0 1 16.5 14 M 17 17 C 16 17 16 17 16 16 L 16 15.5 C 16 14.5 17 14.5 17 15.5 L 17 16 L 17.5 16 C 18.5 16 18.5 17 17.5 17 L 17 17" RenderTransformOrigin="0.5,0.5" HorizontalAlignment="Center" VerticalAlignment="Top" Foreground="#FF5AFF00" />
                                                </Grid>
                                            </Button>
                                            <Button x:Name="Symbols_Insert" Style="{StaticResource CrimsonToolbarButton}" FontFamily="{StaticResource SymbolThemeFontFamily}" Width="40" Height="53" FontSize="22" ToolTipService.ToolTip="Insert symbols" CornerRadius="4,4,4,4" VerticalAlignment="Center" Padding="0,0,0,0" Background="Transparent" BorderBrush="{x:Null}">
                                                <Grid Height="48" Margin="0,-3,0,0">
                                                    <Grid Height="55" HorizontalAlignment="Center" VerticalAlignment="Top" Width="55" RenderTransformOrigin="0.5,0.5" Margin="0,-14,2,0">
                                                        <Grid.RenderTransform>
                                                            <CompositeTransform ScaleX="0.5" ScaleY="0.5"/>
                                                        </Grid.RenderTransform>
                                                        <TextBlock TextWrapping="Wrap" Text="&#xED58;" FontFamily="{StaticResource SymbolThemeFontFamily}" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="30"/>
                                                        <Border Background="{Binding Foreground, ElementName=LeftInd}" VerticalAlignment="Bottom" HorizontalAlignment="Right" Width="2" Height="18" Margin="0,0,11,19" CornerRadius="0,2,0,0"/>
                                                        <Border Background="{Binding Foreground, ElementName=LeftInd}" VerticalAlignment="Bottom" HorizontalAlignment="Right" Width="18" Height="2" Margin="0,0,17,13" CornerRadius="0,0,0,2"/>
                                                        <Border VerticalAlignment="Bottom" HorizontalAlignment="Right" Width="6" Height="6" Margin="0,0,11,13" CornerRadius="0,0,15,0" BorderBrush="{Binding Foreground, ElementName=LeftInd}" BorderThickness="0,0,2,2"/>
                                                    </Grid>
                                                    <TextBlock FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Bottom" TextAlignment="Center" Margin="0,0,0,1"><Run Text="Insert"/><LineBreak/><Run Text="symbols"/></TextBlock>
                                                </Grid>
                                                <Button.Flyout>
                                                    <Flyout Placement="Bottom" x:Name="symbolsflyout2">
                                                        <RelativePanel>
                                                            <StackPanel>
                                                                <VariableSizedWrapGrid
                                    x:Name="symbolGrid2"
                                    MaximumRowsOrColumns="4"
                                    Orientation="Horizontal">
                                                                    <VariableSizedWrapGrid.Resources>
                                                                        <Style TargetType="Button">
                                                                            <Setter Property="Background" Value="Transparent"/>
                                                                            <Setter Property="BorderThickness" Value="0"/>
                                                                            <Setter Property="CornerRadius" Value="4"/>
                                                                            <Setter Property="Margin" Value="4"/>
                                                                        </Style>
                                                                    </VariableSizedWrapGrid.Resources>
                                                                    <Button
                                        AutomationProperties.Name="Mutiply"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Multiplication symbol"
                                         Content="×">
                                                                    </Button>
                                                                    <Button
                                        AutomationProperties.Name="Divide"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Division symbol"
                                                Content="÷">
                                                                    </Button>
                                                                    <Button
                                        AutomationProperties.Name="LeftArrow"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Left Arrow symbol"
                                                Content="←">
                                                                    </Button>
                                                                    <Button
                                        AutomationProperties.Name="RightArrow"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Right Arrow symbol"
                                                Content="→">
                                                                    </Button>
                                                                    <Button
                                        AutomationProperties.Name="Degree"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Degree symbol"
                                                Content="°">
                                                                    </Button>
                                                                    <Button
                                        AutomationProperties.Name="Paragraph"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Paragraph symbol"
                                                Content="§">
                                                                    </Button>
                                                                    <Button
                                        AutomationProperties.Name="Mu"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Lowercase mu (micro) symbol"
                                                Content="µ">
                                                                    </Button>
                                                                    <Button
                                        AutomationProperties.Name="SquareRoot"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Square root symbol"
                                                Content="√">
                                                                    </Button>

                                                                </VariableSizedWrapGrid>
                                                                <Button Content="More symbols" Click="more_symbols" Width="160"/>
                                                            </StackPanel>
                                                        </RelativePanel>
                                                    </Flyout>

                                                </Button.Flyout>
                                            </Button>
                                        </StackPanel>
                                    </Grid>
                                    <Grid x:Name="Help" Height="132">
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="20,27,0,0" Spacing="10">
                                            <Button x:Name="AboutButton" Style="{StaticResource CrimsonToolbarButton}" FontFamily="{StaticResource SymbolThemeFontFamily}" Width="40" Height="53" FontSize="22" Click="AboutBtn_Click" ToolTipService.ToolTip="About" CornerRadius="4,4,4,4" VerticalAlignment="Center" Padding="0,0,0,0" Background="Transparent" BorderBrush="{x:Null}">
                                                <Grid Width="30" Height="45" Margin="4,1,4,-1">
                                                    <TextBlock TextWrapping="Wrap" Text="&#xE897;" FontFamily="{StaticResource SymbolThemeFontFamily}" HorizontalAlignment="Center" VerticalAlignment="Top" FontSize="16"/>
                                                    <TextBlock FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Top" TextAlignment="Center" Margin="0,20,0,0" Width="30"><Run Text="About"/></TextBlock>
                                                </Grid>
                                            </Button>
                                            <Button x:Name="uteverButton" Style="{StaticResource CrimsonToolbarButton}" FontFamily="{StaticResource SymbolThemeFontFamily}" Width="40" Height="53" FontSize="22" ToolTipService.ToolTip="utever" Padding="0,0,0,0" Margin="0,1,0,0" Background="Transparent" BorderBrush="#00000000" CornerRadius="4,4,4,4" Click="uteverclick">
                                                <Grid Width="30" Height="45" Margin="4,1,4,-1">
                                                    <TextBlock TextWrapping="Wrap" Text="&#xE897;" FontFamily="{StaticResource SymbolThemeFontFamily}" HorizontalAlignment="Center" VerticalAlignment="Top" FontSize="16"/>
                                                    <TextBlock FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Top" TextAlignment="Center" Margin="0,20,0,0" Width="30"><Run Text="utever"/></TextBlock>
                                                </Grid>
                                            </Button>
                                        </StackPanel>
                                    </Grid>
                                    <Grid x:Name="Developer" Height="132" RelativePanel.AlignLeftWithPanel="True" RelativePanel.AlignRightWithPanel="True">
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="20,27,0,0" Spacing="10">
                                            <Button x:Name="GenerateHash" Style="{StaticResource CrimsonToolbarButton}" FontFamily="{StaticResource SymbolThemeFontFamily}" Click="ComputeHash_Click" Width="80" Height="53" FontSize="22" ToolTipService.ToolTip="Generate hash/Base64" Padding="0,0,0,0" Margin="0,1,0,0" CornerRadius="4,4,4,4" Background="{x:Null}" BorderBrush="{x:Null}">
                                                <Grid Width="60" Height="45" Margin="4,1,4,-1">
                                                    <TextBlock TextWrapping="Wrap" Text="&#xE943;" FontFamily="{StaticResource SymbolThemeFontFamily}" HorizontalAlignment="Center" VerticalAlignment="Top" FontSize="16"/>
                                                    <TextBlock FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Top" TextAlignment="Center" Margin="0,20,0,0" Width="64"><Run Text="Generate"/><LineBreak/><Run Text="Hash/Base64"/></TextBlock>
                                                </Grid>
                                            </Button>
                                        </StackPanel>
                                    </Grid>
                                    <Grid x:Name="Comments" Height="132" RelativePanel.AlignLeftWithPanel="True" RelativePanel.AlignRightWithPanel="True">
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="20,27,0,0" Spacing="10">
                                            <Button x:Name="CloseComments" Style="{StaticResource CrimsonToolbarButton}" FontFamily="{StaticResource SymbolThemeFontFamily}" Click="closecomments" Width="80" Height="53" FontSize="22" ToolTipService.ToolTip="Close Comments" Padding="0,0,0,0" Margin="0,1,0,0" CornerRadius="4,4,4,4" Background="{x:Null}" BorderBrush="{x:Null}">
                                                <Grid Width="60" Height="45" Margin="4,1,4,-1">
                                                    <TextBlock TextWrapping="Wrap" Text="&#xF716;" FontFamily="{StaticResource SymbolThemeFontFamily}" HorizontalAlignment="Center" VerticalAlignment="Top" FontSize="16"/>
                                                    <TextBlock FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Top" TextAlignment="Center" Margin="0,20,0,0" Width="64"><Run Text="Close"/><LineBreak/><Run Text="Comments"/></TextBlock>
                                                </Grid>
                                            </Button>
                                        </StackPanel>
                                    </Grid>
                                </Grid>
                            </Border>
                        </RelativePanel>
                    </Grid>
                </RelativePanel>
            </RelativePanel>

            <SplitView
            RelativePanel.AlignBottomWithPanel="True"
            RelativePanel.AlignLeftWithPanel="True"
            RelativePanel.AlignRightWithPanel="True"
            RelativePanel.Below="containerPanel"
            muxc:BackdropMaterial.ApplyToRootOrPageBackground="True"
            Background="Transparent"
            PaneBackground="Transparent"
            IsPaneOpen="False" OpenPaneLength="256" CompactPaneLength="24" DisplayMode="Inline" PanePlacement="Right" x:Name="textsplitview">
                <SplitView.Pane>
                    <Grid Background="Transparent">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <StackPanel Orientation="Vertical" Background="Transparent">
                            <muxc:InfoBar IsOpen="True" Severity="Informational" Title="Usage info">
                                <muxc:InfoBar.Content>
                                    <TextBlock Text="Do not abuse the Find and Replace feature by trying to replace too many characters. Hangs or crashes may occur upon intentional overload." TextWrapping="WrapWholeWords"/>
                                </muxc:InfoBar.Content>
                            </muxc:InfoBar>
                            <TextBox x:Name="FindTextBox" TextWrapping="Wrap" AcceptsReturn="True" PlaceholderText="Find" Margin="10,10,10,0" Visibility="Visible"/>
                            <TextBox x:Name="ReplaceBox" TextWrapping="Wrap" AcceptsReturn="True" PlaceholderText="Replace" Margin="10,10,10,0"/>
                            <CheckBox x:Name="CaseSensBox" Content="Case sensitive" Margin="10,10,0,0"/>
                            <CheckBox x:Name="FullWordsBox" Content="Match whole words" Margin="10,0,0,0"/>
                            <Button x:Name="FindBTN" Content="Find" HorizontalAlignment="Stretch" Click="FindBTN_Click"/>
                            <Button x:Name="RepBTN" Content="Replace" HorizontalAlignment="Stretch" Click="RepBTN_Click"/>
                            <Button x:Name="RepAllBTN" Content="Replace all" Click="RepAllBTN_Click" HorizontalAlignment="Stretch"/>
                            <Button x:Name="CancelFindRepBTN" Content="Cancel" HorizontalAlignment="Stretch" Click="CancelFindRepBTN_Click"/>
                            <AppBarButton HorizontalAlignment="Center" Icon="ClosePane" Label="Close" Click="closepane"/>
                        </StackPanel>
                    </Grid>
                </SplitView.Pane>
                <SplitView RelativePanel.AlignBottomWithPanel="True"
            RelativePanel.AlignLeftWithPanel="True"
            RelativePanel.AlignRightWithPanel="True"
            RelativePanel.Below="containerPanel"
            muxc:BackdropMaterial.ApplyToRootOrPageBackground="True"
            Background="Transparent"
            PaneBackground="Transparent"
            IsPaneOpen="False" OpenPaneLength="256" CompactPaneLength="24" DisplayMode="Inline" PanePlacement="Left" x:Name="commentsplitview">
                    <SplitView.Pane>
                        <RichEditBox x:Name="comments">

                        </RichEditBox>
                    </SplitView.Pane>
                    <Grid>
                        <RichEditBox
            x:Name="editor"
            Padding="11"
            FontFamily="Segoe UI"
            IsSpellCheckEnabled="False"
            TextWrapping="WrapWholeWords"
            TextChanged="RichEditBox_TextChanged" SelectionChanged="editor_SelectionChanged" KeyDown="editor_KeyDown">
                            <RichEditBox.KeyboardAccelerators>
                                <KeyboardAccelerator Modifiers="Control" Key="B" Invoked="OnKeyboardAcceleratorInvoked"/>
                                <KeyboardAccelerator Modifiers="Control" Key="I" Invoked="OnKeyboardAcceleratorInvoked" />
                                <KeyboardAccelerator Modifiers="Control" Key="U" Invoked="OnKeyboardAcceleratorInvoked" />
                                <KeyboardAccelerator Modifiers="Control" Key="S" Invoked="OnKeyboardAcceleratorInvoked" />
                            </RichEditBox.KeyboardAccelerators>
                        </RichEditBox>
                        <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="10">
                            <DropDownButton x:Name="SmartEditorHyphen" Visibility="Collapsed" Content="⚡" ToolTipService.ToolTip="SmartEditor - Auto list" PointerEntered="SmartEditorHyphen_PointerEntered" PointerExited="SmartEditorHyphen_PointerExited">
                                <DropDownButton.Flyout>
                                    <MenuFlyout>
                                        <MenuFlyoutItem x:Name="UndoList" Text="Undo" Click="UndoList_Click"/>
                                        <MenuFlyoutItem x:Name="CloseSmartEditorAutoList" Text="Hide" Click="CloseSmartEditorAutoList_Click"/>
                                    </MenuFlyout>
                                </DropDownButton.Flyout>
                            </DropDownButton>
                        </StackPanel>
                        <Grid x:Name="Bottom" RelativePanel.AlignBottomWithPanel="True" RelativePanel.AlignRightWithPanel="True" VerticalAlignment="Bottom" HorizontalAlignment="Right" Margin="0,5,0,5" Padding="0, 0, 0, 5">
                            <Border x:Name="StatusBar" BorderThickness="1" CornerRadius="3,3,3,3" VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="7,0,7,5" Height="35" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">
                                <Border.BorderBrush>
                                    <LinearGradientBrush EndPoint="0,3" MappingMode="Absolute">
                                        <LinearGradientBrush.RelativeTransform>
                                            <ScaleTransform CenterY="0.5" ScaleY="-1"/>
                                        </LinearGradientBrush.RelativeTransform>
                                        <GradientStop Color="#29000000" Offset="0.33"/>
                                        <GradientStop Color="#0F000000" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.BorderBrush>
                                <Grid Margin="0,0,0,-2">
                                    <StackPanel Orientation="Horizontal" Margin="10,5,0,5">
                                        <TextBlock x:Name="WordCount" Text="Word count: 0" Foreground="{ThemeResource DefaultTextForegroundThemeBrush}" VerticalAlignment="Center" Padding="0,0,7,0"/>
                                        <Grid x:Name="SelWordGrid" Margin="5,0,0,0" Padding="0,0,7,0">
                                            <Border BorderThickness="1" Background="#7FD0D0D0" CornerRadius="1,1,1,1" HorizontalAlignment="Left" Width="3"/>
                                            <TextBlock x:Name="SelWordCount" Text="Selected words: 0" Foreground="{ThemeResource DefaultTextForegroundThemeBrush}" VerticalAlignment="Center" Margin="8,0,0,0"/>
                                        </Grid>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </Grid>
                    </Grid>
                </SplitView>
            </SplitView>
            <Grid RelativePanel.AlignHorizontalCenterWithPanel="True" RelativePanel.AlignVerticalCenterWithPanel="True" RelativePanel.AlignBottomWithPanel="True" RelativePanel.AlignRightWithPanel="True" RelativePanel.AlignTopWithPanel="True" RelativePanel.AlignLeftWithPanel="True">
                <diags:MessageBoxesGrid>
                    <diags:MessageBox x:Name="AboutBox" Title="About" IsSingleButton="True" FirstButtonText="OK" RememberPosition="False" MessageBoxHeight="520" MessageBoxWidth="400" CloseButtonStyle="Win32" d:IsHidden="True">
                        <Grid Margin="10,-115,10,0">
                            <Image HorizontalAlignment="Left" Height="100" Margin="5,125,0,0" VerticalAlignment="Top" Width="100" Source="/Assets/utevericon.png"/>
                            <TextBlock HorizontalAlignment="Left" Margin="120,140,0,0" TextWrapping="Wrap" Text="UltraTextEdit UWP Plus" VerticalAlignment="Top" FontSize="16"/>
                            <TextBlock HorizontalAlignment="Left" Margin="120,165,0,0" TextWrapping="Wrap" VerticalAlignment="Top" FontSize="11"><Run Text="10.0.26269.1 - Full release"/><LineBreak/><Run Text="Copyright © 2021-2024 ErrorTek"/><LineBreak/><Run Text="Compiled September 2, 2024"/><LineBreak/><Run Text="GitHub release - UWP"/><LineBreak/><Run/></TextBlock>
                            <StackPanel Margin="0,235,0,0">
                                <HyperlinkButton Content="WinUI 2" Padding="11,6,11,7"/>
                                <HyperlinkButton Content="Windows Community Toolkit" Padding="11,6,11,7"/>
                            </StackPanel>
                            <StackPanel HorizontalAlignment="Right" Margin="0,235,0,0">
                                <HyperlinkButton Content="Win2D" Padding="11,6,11,7"/>
                                <HyperlinkButton Content="MicaUWP" Padding="11,6,11,7"/>
                            </StackPanel>
                            <StackPanel VerticalAlignment="Top" Margin="15,350,15,0" Spacing="15">
                                <TextBlock TextWrapping="Wrap" Text="Developers:" Style="{ThemeResource SubtitleTextBlockStyle}"/>
                                <Grid>
                                    <PersonPicture Width="50" Height="50" HorizontalAlignment="Left" ProfilePicture="/Assets/ProfilePictures/ErrorTek.png"/>
                                    <TextBlock TextWrapping="Wrap" Text="ErrorTek" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="65,0,0,0" FontSize="16"/>
                                </Grid>
                                <Grid>
                                    <PersonPicture Width="50" Height="50" HorizontalAlignment="Left" ProfilePicture="/Assets/ProfilePictures/Ivirius.png"/>
                                    <TextBlock TextWrapping="Wrap" Text="Ivirius" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="65,0,0,0" FontSize="16"/>
                                </Grid>
                            </StackPanel>
                        </Grid>

                    </diags:MessageBox>
                </diags:MessageBoxesGrid>
            </Grid>
        </RelativePanel>
        <Border x:Name="HomePage" d:IsHidden="False" Visibility="Collapsed">
            <Border BorderBrush="#FF777777" BorderThickness="1" CornerRadius="8,8,8,8" Margin="15,15,15,15">
                <Grid x:FieldModifier="public" Background="{Binding Background, ElementName=PageTitleBar}">
                    <Border x:Name="HomeAccentBackground" BorderThickness="0,0,0,0" Visibility="{Binding Visibility, ElementName=AccentBackground}">
                        <Border.Background>

                            <AcrylicBrush BackgroundSource="HostBackdrop" TintColor="{ThemeResource SystemAccentColor}" TintOpacity="0.35" FallbackColor="{ThemeResource SystemAccentColor}"/>
                        </Border.Background>
                    </Border>
                    <Border BorderThickness="0,1,0,0" Height="135" Background="{ThemeResource SystemControlBackgroundAltMediumLowBrush}" BorderBrush="#338A8A8A" VerticalAlignment="Bottom"/>
                    <TextBlock TextWrapping="Wrap" Text="Home" Margin="55,18,0,0" HorizontalAlignment="Left" VerticalAlignment="Top"/>
                    <Button x:Name="HideHome" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Width="45" Height="45" Click="HideHome_Click" FontFamily="{StaticResource SymbolThemeFontFamily}" FontSize="10" Background="{x:Null}" BorderBrush="{x:Null}" ToolTipService.ToolTip="Go to workspace" VerticalAlignment="Top" HorizontalAlignment="Right" Padding="0,0,0,0" BorderThickness="0,0,0,0" CornerRadius="0,7,0,0">
                        <TextBlock TextWrapping="Wrap" VerticalAlignment="Center" HorizontalAlignment="Center" FontFamily="{StaticResource SymbolThemeFontFamily}" Text="&#xE106;" FontSize="14"/>
                    </Button>
                    <Image Source="/Assets/Home.png" Stretch="UniformToFill" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="15,15,0,0" Width="25" Height="25"/>
                    <StackPanel Spacing="0" Margin="0,400,0,0"/>
                    <Grid Margin="25,0,0,20" VerticalAlignment="Bottom">
                        <Image Height="100" Width="100" Source="/Assets/utevericon.png" HorizontalAlignment="Left"/>
                        <TextBlock TextWrapping="Wrap" Text="UltraTextEdit UWP+" Margin="120,0,0,40" VerticalAlignment="Center" FontSize="18"/>
                        <TextBlock TextWrapping="Wrap" Text="build 26269.1 - © jpbandroid, Ivirius 2021 - 2024" Margin="120,10,0,0" VerticalAlignment="Center" FontSize="12"/>
                        <StackPanel Orientation="Horizontal" Margin="120,50,0,0">
                            <HyperlinkButton x:Name="hyperlinkButton" Content="https://errortek.vercel.app/" NavigateUri="https://errortek.vercel.app/" Padding="0,0,0,0" FontSize="11"/>
                            <HyperlinkButton x:Name="hyperlinkButton2" Content="https://ivirius.vercel.app/" NavigateUri="https://ivirius.vercel.app/" Padding="0,0,0,0" FontSize="11"/>
                        </StackPanel>
                    </Grid>
                    <muxc:NavigationView HorizontalAlignment="Left" Width="320" Height="Auto" SelectedItem="HomeNavItem" PaneDisplayMode="Left" x:Name="HomeNav" VerticalAlignment="Stretch" Margin="15,50,0,135" SelectionChanged="NavigationView_SelectionChanged" IsPaneToggleButtonVisible="False" IsBackButtonVisible="Collapsed">
                        <muxc:NavigationView.MenuItems>
                            <muxc:NavigationViewItem Icon="Home" Content="Home" Tag="HomeNavItem" x:Name="HomeNavItem"/>
                            <muxc:NavigationViewItem Content="New" Icon="Document" x:Name="NewNavItem"/>
                            <muxc:NavigationViewItemSeparator/>
                            <muxc:NavigationViewItem Icon="OpenFile" Content="Open"/>
                            <muxc:NavigationViewItem Icon="Save" Content="Save"/>
                            <muxc:NavigationViewItem Icon="Share" Content="Share"/>
                            <muxc:NavigationViewItem Icon="Delete" Content="Delete"/>
                        </muxc:NavigationView.MenuItems>
                        <muxc:NavigationView.FooterMenuItems>
                            <muxc:NavigationViewItem Content="Account" Icon="Contact" x:Name="AccountNavItem"/>
                        </muxc:NavigationView.FooterMenuItems>
                    </muxc:NavigationView>
                    <StackPanel Margin="350,60,25,160" Spacing="10" x:Name="HomePanel">
                        <TextBlock Text="Hey there!" FontSize="36" FontWeight="SemiBold"/>
                        <muxc:Expander Header="New File" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left">
                            <ToolkitControls:WrapPanel HorizontalSpacing="10" VerticalSpacing="10">
                                <Button Height="215" Click="InsertBlank" Width="185" Padding="0,0,0,0" VerticalAlignment="Top" Background="Transparent" BorderThickness="0">
                                    <Grid Width="180" Height="200" Margin="0,10,0,0">
                                        <Border Background="White" Height="175" Width="150" VerticalAlignment="Top" HorizontalAlignment="Center" CornerRadius="8"/>
                                        <TextBlock TextWrapping="Wrap" VerticalAlignment="Bottom" HorizontalAlignment="Center" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Blank"/>
                                    </Grid>
                                </Button>
                                <Button Height="215" Click="Button_Click_21" Width="185" Padding="0,0,0,0" VerticalAlignment="Top" Background="Transparent" BorderThickness="0">
                                    <Grid Width="180" Height="200" Margin="0,10,0,0">
                                        <Border Background="White" Height="175" Width="150" VerticalAlignment="Top" HorizontalAlignment="Center" CornerRadius="8"/>
                                        <Image Source="/Assets/Templates/EssayTemp.png" Stretch="UniformToFill" VerticalAlignment="Top" Width="148" HorizontalAlignment="Center" Height="150" Margin="0,10,0,0"/>
                                        <TextBlock TextWrapping="Wrap" VerticalAlignment="Bottom" HorizontalAlignment="Center" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Essay"/>
                                    </Grid>
                                </Button>
                                <Button Height="215" Click="Button_Click_22" Width="185" Padding="0,0,0,0" VerticalAlignment="Top" Background="Transparent" BorderThickness="0">
                                    <Grid Width="180" Height="200" Margin="0,10,0,0">
                                        <Border Background="White" Height="175" Width="150" VerticalAlignment="Top" HorizontalAlignment="Center" CornerRadius="8"/>
                                        <Image Source="/Assets/Templates/ResumeTemp.png" Stretch="UniformToFill" VerticalAlignment="Top" Width="148" HorizontalAlignment="Center" Height="150" Margin="0,10,0,0"/>
                                        <TextBlock TextWrapping="Wrap" VerticalAlignment="Bottom" HorizontalAlignment="Center" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Résumé"/>
                                    </Grid>
                                </Button>
                                <Button Height="215" Click="Button_Click_23" Width="185" Padding="0,0,0,0" VerticalAlignment="Top" Background="Transparent" BorderThickness="0">
                                    <Grid Width="180" Height="200" Margin="0,10,0,0">
                                        <Border Background="White" Height="175" Width="150" VerticalAlignment="Top" HorizontalAlignment="Center" CornerRadius="8"/>
                                        <Image Source="/Assets/Templates/CreditsTemp.png" Stretch="UniformToFill" VerticalAlignment="Top" Width="148" HorizontalAlignment="Center" Height="150" Margin="0,10,0,0"/>
                                        <TextBlock TextWrapping="Wrap" VerticalAlignment="Bottom" HorizontalAlignment="Center" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Credits"/>
                                    </Grid>
                                </Button>
                            </ToolkitControls:WrapPanel>
                        </muxc:Expander>
                    </StackPanel>
                    <StackPanel Margin="350,60,25,160" Spacing="10" x:Name="NewPanel" Visibility="Collapsed">
                        <TextBlock Text="New File" FontSize="36" FontWeight="SemiBold"/>
                        <ScrollViewer Margin="0, 75, 0, 0" VerticalScrollMode="Enabled">
                            <StackPanel>
                                <ToolkitControls:WrapPanel>
                                    <Button Height="325" Click="InsertBlank" Width="250" Padding="0,0,0,0" VerticalAlignment="Top" Background="Transparent" BorderThickness="0">
                                        <Grid Margin="0,10,0,0">
                                            <Border Background="White" Height="250" Width="175" Margin="0,0,0,30" VerticalAlignment="Top" HorizontalAlignment="Center" CornerRadius="8"/>
                                            <TextBlock TextWrapping="Wrap" VerticalAlignment="Bottom" HorizontalAlignment="Center" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Blank"/>
                                        </Grid>
                                    </Button>
                                    <Button Height="325" Click="Button_Click_21" Width="250" Padding="0,0,0,0" VerticalAlignment="Top" Background="Transparent" BorderThickness="0">
                                        <Grid Margin="0,10,0,0">
                                            <Border Background="White" Height="250" Width="175" Margin="0,0,0,30" VerticalAlignment="Top" HorizontalAlignment="Center" CornerRadius="8"/>
                                            <Image Source="/Assets/Templates/EssayTemp.png" Stretch="UniformToFill" VerticalAlignment="Top" Width="175" HorizontalAlignment="Center" Height="173" Margin="0,10,0,0"/>
                                            <TextBlock TextWrapping="Wrap" VerticalAlignment="Bottom" HorizontalAlignment="Center" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Essay"/>
                                        </Grid>
                                    </Button>
                                    <Button Height="325" Click="Button_Click_22" Width="250" Padding="0,0,0,0" VerticalAlignment="Top" Background="Transparent" BorderThickness="0">
                                        <Grid Margin="0,10,0,0">
                                            <Border Background="White" Height="250" Width="175" Margin="0,0,0,30" VerticalAlignment="Top" HorizontalAlignment="Center" CornerRadius="8"/>
                                            <Image Source="/Assets/Templates/ResumeTemp.png" Stretch="UniformToFill" VerticalAlignment="Top" Width="175" HorizontalAlignment="Center" Height="173" Margin="0,10,0,0"/>
                                            <TextBlock TextWrapping="Wrap" VerticalAlignment="Bottom" HorizontalAlignment="Center" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Résumé"/>
                                        </Grid>
                                    </Button>
                                    <Button Height="325" Click="Button_Click_23" Width="250" Padding="0,0,0,0" VerticalAlignment="Top" Background="Transparent" BorderThickness="0">
                                        <Grid Margin="0,10,0,0">
                                            <Border Background="White" Height="250" Width="175" Margin="0,0,0,30" VerticalAlignment="Top" HorizontalAlignment="Center" CornerRadius="8"/>
                                            <Image Source="/Assets/Templates/CreditsTemp.png" Stretch="UniformToFill" VerticalAlignment="Top" Width="175" HorizontalAlignment="Center" Height="173" Margin="0,10,0,0"/>
                                            <TextBlock TextWrapping="Wrap" VerticalAlignment="Bottom" HorizontalAlignment="Center" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Credits"/>
                                        </Grid>
                                    </Button>
                                    <Button Height="325" Click="Button_Click_24" Width="250" Padding="0,0,0,0" VerticalAlignment="Top" Background="Transparent" BorderThickness="0">
                                        <Grid Margin="0,10,0,0">
                                            <Border Background="White" Height="250" Width="175" Margin="0,0,0,30" VerticalAlignment="Top" HorizontalAlignment="Center" CornerRadius="8"/>
                                            <Image Source="/Assets/Templates/ImageEssayTemp.png" Stretch="UniformToFill" VerticalAlignment="Top" Width="175" HorizontalAlignment="Center" Height="173" Margin="0,10,0,0"/>
                                            <TextBlock TextWrapping="Wrap" VerticalAlignment="Bottom" HorizontalAlignment="Center" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Image Essay"/>
                                        </Grid>
                                    </Button>
                                    <Button Height="325" Click="Button_Click_25" Width="250" Padding="0,0,0,0" VerticalAlignment="Top" Background="Transparent" BorderThickness="0">
                                        <Grid Margin="0,10,0,0">
                                            <Border Background="White" Height="250" Width="175" Margin="0,0,0,30" VerticalAlignment="Top" HorizontalAlignment="Center" CornerRadius="8"/>
                                            <Image Source="/Assets/Templates/ImageGalleryTemp.png" Stretch="UniformToFill" VerticalAlignment="Top" Width="175" HorizontalAlignment="Center" Height="173" Margin="0,10,0,0"/>
                                            <TextBlock TextWrapping="Wrap" VerticalAlignment="Bottom" HorizontalAlignment="Center" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Image Gallery"/>
                                        </Grid>
                                    </Button>
                                    <Button Height="325" Click="Button_Click_26" Width="250" Padding="0,0,0,0" VerticalAlignment="Top" Background="Transparent" BorderThickness="0">
                                        <Grid Margin="0,10,0,0">
                                            <Border Background="White" Height="250" Width="175" Margin="0,0,0,30" VerticalAlignment="Top" HorizontalAlignment="Center" CornerRadius="8"/>
                                            <Image Source="/Assets/Templates/NewspaperTemp.png" Stretch="UniformToFill" VerticalAlignment="Top" Width="175" HorizontalAlignment="Center" Height="173" Margin="0,10,0,0"/>
                                            <TextBlock TextWrapping="Wrap" VerticalAlignment="Bottom" HorizontalAlignment="Center" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Newspaper"/>
                                        </Grid>
                                    </Button>
                                </ToolkitControls:WrapPanel>
                            </StackPanel>
                        </ScrollViewer>
                    </StackPanel>
                    <Grid x:Name="AccountsStackPanel" Margin="350,60,25,160" Visibility="Collapsed">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="0.5*"/>
                            <ColumnDefinition Width="0.5*"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" Orientation="Vertical" Width="Auto">
                            <TextBlock Text="Account" Style="{ThemeResource BodyStrongTextBlockStyle}"/>
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <muxc:PersonPicture/>
                                <TextBlock x:Name="UserText" Text="User" TextAlignment="Center" VerticalAlignment="Center" HorizontalTextAlignment="Center" FontSize="24" FontWeight="SemiBold"/>
                            </StackPanel>
                        </StackPanel>
                        <StackPanel Grid.Column="1" Orientation="Vertical" Width="Auto">
                            <TextBlock Text="About UltraTextEdit UWP Plus" Style="{ThemeResource BodyStrongTextBlockStyle}"/>
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <Image Height="150" Width="150" Source="/Assets/utevericon.png"/>
                                <TextBlock Text="UTE UWP+" Style="{ThemeResource TitleLargeTextBlockStyle}" VerticalAlignment="Center" TextAlignment="Center">
                                    <TextBlock.Foreground>
                                        <LinearGradientBrush>
                                            <GradientStop Color="#FF4B5BB3"/>
                                            <GradientStop Color="#FF65A7FF" Offset="1"/>
                                        </LinearGradientBrush>
                                    </TextBlock.Foreground>
                                </TextBlock>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <Button Click="AboutItem_Click" Width="150">
                                    <StackPanel Orientation="Vertical">
                                        <IconSourceElement>
                                            <SymbolIconSource Symbol="Help"/>
                                        </IconSourceElement>
                                        <TextBlock Text="About"/>
                                    </StackPanel>
                                </Button>
                                <StackPanel Orientation="Vertical">
                                    <TextBlock Text="Build 26269.1"/>
                                    <TextBlock Text="Dev Channel"/>
                                </StackPanel>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <Button Click="ChangelogButton_Click" Width="150">
                                    <StackPanel Orientation="Vertical">
                                        <IconSourceElement>
                                            <FontIconSource Glyph="&#xF0E3;"/>
                                        </IconSourceElement>
                                        <TextBlock Text="Changelog"/>
                                    </StackPanel>
                                </Button>
                                <StackPanel Orientation="Vertical">
                                    <TextBlock Text="Find out what's new in this update" TextWrapping="WrapWholeWords"/>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                    <Frame x:Name="SettingsFrame" Margin="350,60,25,160" Visibility="Collapsed"/>
                </Grid>
            </Border>
        </Border>

    </Grid>
</Page>
