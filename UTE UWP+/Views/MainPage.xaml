<Page
    x:Class="UTE_UWP_.Views.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:Microsoft.Toolkit.Uwp.UI.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:UTE_UWP_"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    muxc:BackdropMaterial.ApplyToRootOrPageBackground="True"
    mc:Ignorable="d"
    xmlns:appmodel="using:Windows.ApplicationModel" xmlns:diags="using:UltraTextEdit_UWP.UserControls"
    d:DesignHeight="564"
    d:DesignWidth="876">

    <Page.Resources>
        <Style x:Key="TitleBarCaptionTextBlockStyle" TargetType="TextBlock" BasedOn="{StaticResource BaseTextBlockStyle}">
            <Setter Property="FontSize" Value="12" />
            <Setter Property="FontWeight" Value="Normal" />
            <Setter Property="Foreground" Value="{ThemeResource SystemAccentColor}"/>
        </Style>
        <Flyout x:Key="myColorPickerFlyout">
            <RelativePanel>
                <ColorPicker x:Name="myColorPicker"
                         IsColorChannelTextInputVisible="True"
                         IsHexInputVisible="True"/>

                <Grid RelativePanel.Below="myColorPicker"
                  RelativePanel.AlignLeftWithPanel="True"
                  RelativePanel.AlignRightWithPanel="True">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Button Content="OK" Click="ConfirmColor_Click"
                            Style="{StaticResource AccentButtonStyle}"
                        Margin="0,12,2,0" HorizontalAlignment="Stretch"/>
                    <Button Content="Cancel" Click="CancelColor_Click"
                        Margin="2,12,0,0" HorizontalAlignment="Stretch"
                        Grid.Column="1"/>
                </Grid>
            </RelativePanel>
        </Flyout>
    </Page.Resources>
    <Grid>
        <RelativePanel Background="{StaticResource TabViewItemHeaderBackground}">

            <Border x:Name="HomePage" Background="#59000000" d:IsHidden="True" Visibility="Collapsed" RelativePanel.AlignHorizontalCenterWithPanel="True" RelativePanel.AlignVerticalCenterWithPanel="True" Canvas.ZIndex="10">
                <Border BorderBrush="#FF777777" BorderThickness="1" CornerRadius="8,8,8,8" MaxWidth="825" MaxHeight="775">
                    <Grid x:FieldModifier="public" Background="{Binding Background, ElementName=PageTitleBar}">
                        <Border x:Name="HomeAccentBackground" BorderThickness="0,0,0,0" Visibility="{Binding Visibility, ElementName=AccentBackground}">
                            <Border.Background>

                                <AcrylicBrush BackgroundSource="HostBackdrop" TintColor="{ThemeResource SystemAccentColor}" TintOpacity="0.35" FallbackColor="{ThemeResource SystemAccentColor}"/>
                            </Border.Background>
                        </Border>
                        <Border BorderThickness="0,1,0,0" Height="135" Background="{ThemeResource SystemControlBackgroundAltMediumLowBrush}" BorderBrush="#338A8A8A" VerticalAlignment="Bottom"/>
                        <TextBlock TextWrapping="Wrap" Text="Home" Margin="55,18,0,0" HorizontalAlignment="Left" VerticalAlignment="Top"/>
                        <Button x:Name="HideHome" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Width="45" Height="45" Click="HideHome_Click" FontFamily="{ThemeResource SymbolThemeFontFamily}" FontSize="10" Background="{x:Null}" BorderBrush="{x:Null}" ToolTipService.ToolTip="Go to workspace" VerticalAlignment="Top" HorizontalAlignment="Right" Padding="0,0,0,0" BorderThickness="0,0,0,0" CornerRadius="0,7,0,0">
                            <TextBlock TextWrapping="Wrap" VerticalAlignment="Center" HorizontalAlignment="Center" FontFamily="{ThemeResource SymbolThemeFontFamily}" Text="&#xE106;" FontSize="14"/>
                        </Button>
                        <Image Source="/Assets/Glyphs/Home.png" Stretch="UniformToFill" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="15,15,0,0" Width="25" Height="25"/>
                        <StackPanel Spacing="0" Margin="0,400,0,0"/>
                        <Grid Margin="25,0,0,20" VerticalAlignment="Bottom">
                            <Image Height="100" Width="100" Source="/Assets/utevericon.png" HorizontalAlignment="Left"/>
                            <TextBlock TextWrapping="Wrap" Text="UltraTextEdit UWP+" Margin="120,0,0,40" VerticalAlignment="Center" FontSize="18"/>
                            <TextBlock TextWrapping="Wrap" Text="build 25982.1000 - © jpbandroid, Ivirius 2021 - 2024" Margin="120,10,0,0" VerticalAlignment="Center" FontSize="12"/>
                            <StackPanel Orientation="Horizontal" Margin="120,50,0,0">
                                <HyperlinkButton x:Name="hyperlinkButton" Content="https://errortek.vercel.app/" NavigateUri="https://errortek.vercel.app/" Padding="0,0,0,0" FontSize="11"/>
                                <HyperlinkButton x:Name="hyperlinkButton2" Content="https://ivirius.vercel.app/" NavigateUri="https://ivirius.vercel.app/" Padding="0,0,0,0" FontSize="11"/>
                            </StackPanel>
                            </Grid>
                        <Border Width="50" Height="50" HorizontalAlignment="Left" VerticalAlignment="Top" CornerRadius="4,4,4,4" Margin="15,64,0,0" Background="#268E8E8E"/>
                        <Border Background="{Binding Foreground, ElementName=LeftInd}" Height="24" CornerRadius="1.5,1.5,1.5,1.5" Width="3" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="15,77,0,0"/>
                        <StackPanel HorizontalAlignment="Left" VerticalAlignment="Top" Margin="15,120,0,0" Spacing="5">
                            <Button Background="Transparent" BorderThickness="0,0,0,0" Width="50" Height="50" Click="OpenButton_Click" ToolTipService.ToolTip="Open">
                                <TextBlock Text="&#xE1A5;" FontFamily="{ThemeResource SymbolThemeFontFamily}" FontSize="24" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Button>
                            <Button Background="Transparent" BorderThickness="0,0,0,0" Width="50" Height="50" Click="MenuFlyoutItem_Click_35" ToolTipService.ToolTip="Open multiple files (coming soon)" IsEnabled="False">
                                <TextBlock Text="&#xE1A5;" FontFamily="{ThemeResource SymbolThemeFontFamily}" FontSize="24" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{Binding Foreground, ElementName=LeftInd}"/>
                            </Button>
                            <Button Background="Transparent" BorderThickness="0,0,0,0" Width="50" Height="50" Click="SaveButton_Click" ToolTipService.ToolTip="Save">
                                <TextBlock Text="&#xE105;" FontFamily="{ThemeResource SymbolThemeFontFamily}" FontSize="24" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Button>
                            <Button Background="Transparent" BorderThickness="0,0,0,0" Width="50" Height="50" Click="SaveAsButton_Click" ToolTipService.ToolTip="Save as">
                                <TextBlock Text="&#xEA35;" FontFamily="{ThemeResource SymbolThemeFontFamily}" FontSize="24" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Button>
                            <Button Background="Transparent" BorderThickness="0,0,0,0" Width="50" Height="50" Click="DelB_Click" ToolTipService.ToolTip="Delete">
                                <TextBlock Text="&#xE107;" FontFamily="{ThemeResource SymbolThemeFontFamily}" FontSize="24" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Button>
                            <Button Background="Transparent" BorderThickness="0,0,0,0" Width="50" Height="50" Click="PntB_Click" ToolTipService.ToolTip="Print (BETA)" Padding="0,0,0,0">
                                <Grid>
                                    <TextBlock Text="&#xF56D;" FontFamily="{ThemeResource SymbolThemeFontFamily}" FontSize="24" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="#FFDC5454" Margin="0,0,2,0"/>
                                </Grid>
                            </Button>
                        </StackPanel>
                        <TextBlock Text="&#xE130;" FontSize="24" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="28,75,0,0"/>
                        <StackPanel Margin="100,60,25,160" Spacing="10">
                            <TextBlock TextWrapping="Wrap" Text="New File" FontSize="24"/>
                            <Button Height="135" Click="NewFile_Click" Width="150" Padding="0,0,0,0">
                                <Grid Width="148" Height="133">
                                    <Border CornerRadius="3,3,0,0" Margin="0,0,0,35" Height="NaN" Width="188" HorizontalAlignment="Center" Background="White"/>
                                    <Border VerticalAlignment="Bottom" CornerRadius="0,0,3,3" Height="35">
                                        <Border.Background>
                                            <LinearGradientBrush>
                                                <GradientStop Color="#FF4B5BB3"/>
                                                <GradientStop Color="#FF65A7FF" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                        <TextBlock TextWrapping="Wrap" VerticalAlignment="Center" HorizontalAlignment="Left" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Blank" Foreground="White"/>
                                    </Border>
                                </Grid>
                            </Button>
                            <TextBlock TextWrapping="Wrap" Text="Templates" FontSize="24" Margin="0,15,0,0"/>
                            <Grid>
                                <Button Height="135" Click="Button_Click_21" Width="150" Padding="0,0,0,0" VerticalAlignment="Top">
                                    <Grid Width="148" Height="133">
                                        <Image Source="/Assets/Templates/EssayTemp.png" Stretch="UniformToFill" VerticalAlignment="Top" Width="148" HorizontalAlignment="Left" Height="125"/>
                                        <Border CornerRadius="3,3,0,0" Margin="0,0,0,35" Height="NaN" Width="188" HorizontalAlignment="Center"/>
                                        <Border VerticalAlignment="Bottom" CornerRadius="0,0,3,3" Height="35">
                                            <Border.Background>
                                                <LinearGradientBrush>
                                                    <GradientStop Color="#FF4B5BB3"/>
                                                    <GradientStop Color="#FF65A7FF" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <TextBlock TextWrapping="Wrap" VerticalAlignment="Center" HorizontalAlignment="Left" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Essay" Foreground="White"/>
                                        </Border>
                                    </Grid>
                                </Button>
                                <Button Height="135" Click="Button_Click_22" Width="150" Padding="0,0,0,0" VerticalAlignment="Top" Margin="175,0,0,0">
                                    <Grid Width="148" Height="133">
                                        <Image Source="/Assets/Templates/ResumeTemp.png" Stretch="UniformToFill" VerticalAlignment="Top" Width="148" HorizontalAlignment="Left" Height="125"/>
                                        <Border CornerRadius="3,3,0,0" Margin="0,0,0,35" Height="NaN" Width="188" HorizontalAlignment="Center"/>
                                        <Border VerticalAlignment="Bottom" CornerRadius="0,0,3,3" Height="35">
                                            <Border.Background>
                                                <LinearGradientBrush>
                                                    <GradientStop Color="#FF4B5BB3"/>
                                                    <GradientStop Color="#FF65A7FF" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <TextBlock TextWrapping="Wrap" VerticalAlignment="Center" HorizontalAlignment="Left" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Resume" Foreground="White"/>
                                        </Border>
                                    </Grid>
                                </Button>
                                <Button Height="135" Click="Button_Click_23" Width="150" Padding="0,0,0,0" VerticalAlignment="Top" Margin="350,0,0,0">
                                    <Grid Width="148" Height="133">
                                        <Image Source="/Assets/Templates/CreditsTemp.png" Stretch="UniformToFill" VerticalAlignment="Top" Width="148" HorizontalAlignment="Left" Height="125"/>
                                        <Border CornerRadius="3,3,0,0" Margin="0,0,0,35" Height="NaN" Width="188" HorizontalAlignment="Center"/>
                                        <Border VerticalAlignment="Bottom" CornerRadius="0,0,3,3" Height="35">
                                            <Border.Background>
                                                <LinearGradientBrush>
                                                    <GradientStop Color="#FF4B5BB3"/>
                                                    <GradientStop Color="#FF65A7FF" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <TextBlock TextWrapping="Wrap" VerticalAlignment="Center" HorizontalAlignment="Left" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Credits" Foreground="White"/>
                                        </Border>
                                    </Grid>
                                </Button>
                                <Button Height="135" Click="Button_Click_24" Width="150" Padding="0,0,0,0" VerticalAlignment="Top" Margin="525,0,0,0">
                                    <Grid Width="148" Height="133">
                                        <Image Stretch="UniformToFill" VerticalAlignment="Top" Width="148" HorizontalAlignment="Left" Height="125" Source="/Assets/Templates/ImageEssayTemp.png"/>
                                        <Border CornerRadius="3,3,0,0" Margin="0,0,0,35" Height="NaN" Width="188" HorizontalAlignment="Center"/>
                                        <Border VerticalAlignment="Bottom" CornerRadius="0,0,3,3" Height="35">
                                            <Border.Background>
                                                <LinearGradientBrush>
                                                    <GradientStop Color="#FF4B5BB3"/>
                                                    <GradientStop Color="#FF65A7FF" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <TextBlock TextWrapping="Wrap" VerticalAlignment="Center" HorizontalAlignment="Left" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Image Essay" Foreground="White"/>
                                        </Border>
                                    </Grid>
                                </Button>
                                <Button Height="135" Click="Button_Click_25" Width="150" Padding="0,0,0,0" VerticalAlignment="Top" Margin="0,160,0,0">
                                    <Grid Width="148" Height="133">
                                        <Image Stretch="UniformToFill" VerticalAlignment="Top" Width="148" HorizontalAlignment="Left" Height="125" Source="/Assets/Templates/ImageGalleryTemp.png"/>
                                        <Border CornerRadius="3,3,0,0" Margin="0,0,0,35" Height="NaN" Width="188" HorizontalAlignment="Center"/>
                                        <Border VerticalAlignment="Bottom" CornerRadius="0,0,3,3" Height="35">
                                            <Border.Background>
                                                <LinearGradientBrush>
                                                    <GradientStop Color="#FF4B5BB3"/>
                                                    <GradientStop Color="#FF65A7FF" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <TextBlock TextWrapping="Wrap" VerticalAlignment="Center" HorizontalAlignment="Left" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Image Gallery" Foreground="White"/>
                                        </Border>
                                    </Grid>
                                </Button>
                                <Button Height="135" Click="Button_Click_26" Width="150" Padding="0,0,0,0" VerticalAlignment="Top" Margin="175,160,0,0">
                                    <Grid Width="148" Height="133">
                                        <Image Stretch="UniformToFill" VerticalAlignment="Top" Width="148" HorizontalAlignment="Left" Height="125" Source="/Assets/Templates/NewspaperTemp.png"/>
                                        <Border CornerRadius="3,3,0,0" Margin="0,0,0,35" Height="NaN" Width="188" HorizontalAlignment="Center"/>
                                        <Border VerticalAlignment="Bottom" CornerRadius="0,0,3,3" Height="35">
                                            <Border.Background>
                                                <LinearGradientBrush>
                                                    <GradientStop Color="#FF4B5BB3"/>
                                                    <GradientStop Color="#FF65A7FF" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <TextBlock TextWrapping="Wrap" VerticalAlignment="Center" HorizontalAlignment="Left" Padding="0,0,0,0" FontSize="14" Margin="10,0,0,2" Text="Newspaper" Foreground="White"/>
                                        </Border>
                                    </Grid>
                                </Button>
                            </Grid>
                        </StackPanel>
                    </Grid>
                </Border>
            </Border>
            <RelativePanel
            x:Name="containerPanel"
            RelativePanel.AlignLeftWithPanel="True"
            RelativePanel.AlignRightWithPanel="True">
                <StackPanel x:Name="TitleBar" Orientation="Horizontal">
                    <Border
                x:Name="AppTitleBar"
                Height="40"
                Margin="12,2,0,0"
                VerticalAlignment="Top"
                Background="Transparent"
                Canvas.ZIndex="1"
                IsHitTestVisible="True"
                RelativePanel.AlignLeftWithPanel="True"
                RelativePanel.AlignRightWithPanel="True">
                        <StackPanel Orientation="Horizontal" Width="Auto">
                            <Image
                        x:Name="AppFontIcon"
                        Width="24"
                        Height="24"
                        Margin="0,2,0,0"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Source="ms-appx:///Assets/Square44x44Logo.png" />
                            <TextBlock
                        x:Name="AppTitle"
                        Margin="12,2,4,0"
                        VerticalAlignment="Center"
                        Text="Untitled - UTE UWP"
                        FontSize="12"
                        FontWeight="Normal" Foreground="{ThemeResource SystemAccentColor}"/>
                        </StackPanel>
                    </Border>
                    <Grid x:Name="InsiderGrid">
                        <Button Background="#FFFFC225" Width="50" Height="25" Padding="0" CornerRadius="8" Click="showinsiderinfo">
                            <Grid>
                                <TextBlock Text="DEV" TextAlignment="Center" VerticalAlignment="Center" FontWeight="Bold"></TextBlock>
                            </Grid>
                        </Button>
                        <muxc:TeachingTip x:Name="ToggleThemeTeachingTip1"
    Target="{x:Bind InsiderGrid}"
    Title="Dev Channel"
    Subtitle="The Dev Channel is the Insider Channel that receives builds with the latest features and may contain features that may not get released to the public. Beware, as these builds may be buggy or crash!">
                            <muxc:TeachingTip.IconSource>
                                <muxc:FontIconSource  Glyph="&#xF1AD;"/>
                            </muxc:TeachingTip.IconSource>
                        </muxc:TeachingTip>
                    </Grid>
                    <TextBlock
                        x:Name="UnsavedTextBlock"
                        Padding="5,0"
                        VerticalAlignment="Center"
                        Text="* Not Saved"
                        ToolTipService.ToolTip="There are unsaved changes." />
                </StackPanel>

                <StackPanel
                x:Name="MenuPanel"
                VerticalAlignment="Center"
                Orientation="Horizontal"
                RelativePanel.Below="TitleBar">
                    <muxc:MenuBar
                    x:Name="menu"
                    Margin="5,0,0,0"
                    VerticalAlignment="Center">
                        <muxc:MenuBarItem Title="File" d:Title="File">
                            <muxc:MenuBarItem.Background>
                                <SolidColorBrush Color="{ThemeResource SystemAccentColor}"/>
                            </muxc:MenuBarItem.Background>
                            <MenuFlyoutItem Click="NewDoc_Click" Text="New Untabbed Window" x:Name="untabbedwindow">
                                <MenuFlyoutItem.Icon>
                                    <PathIcon Data="M18.5 20a.5.5 0 0 1-.5.5h-5.732A6.518 6.518 0 0 1 11.19 22H18a2 2 0 0 0 2-2V9.828a2 2 0 0 0-.586-1.414l-5.829-5.828a.491.491 0 0 0-.049-.04.63.63 0 0 1-.036-.03 2.072 2.072 0 0 0-.219-.18.652.652 0 0 0-.08-.044l-.048-.024-.05-.029c-.054-.031-.109-.063-.166-.087a1.977 1.977 0 0 0-.624-.138c-.02-.001-.04-.004-.059-.007A.605.605 0 0 0 12.172 2H6a2 2 0 0 0-2 2v7.498a6.451 6.451 0 0 1 1.5-.422V4a.5.5 0 0 1 .5-.5h6V8a2 2 0 0 0 2 2h4.5v10Zm-5-15.379L17.378 8.5H14a.5.5 0 0 1-.5-.5V4.621Z M12 17.5a5.5 5.5 0 1 0-11 0 5.5 5.5 0 0 0 11 0ZM7 18l.001 2.503a.5.5 0 1 1-1 0V18H3.496a.5.5 0 0 1 0-1H6v-2.5a.5.5 0 1 1 1 0V17h2.497a.5.5 0 0 1 0 1H7Z"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                            <MenuFlyoutItem Click="NewInstance_Click" Text="New Tabbed Window" x:Name="tabbedwindow">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE78B;" />
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                            <MenuFlyoutItem Click="OpenButton_Click" Text="Open" Icon="OpenFile"/>
                            <MenuFlyoutItem Click="SaveButton_Click" Text="Save" Icon="Save"/>
                            <MenuFlyoutItem Click="SaveAsButton_Click" Text="SaveAsCopy">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE792;" />
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                            <MenuFlyoutItem Click="Print_Click" Text="Print"  Icon="Print"/>
                            <MenuFlyoutSeparator />
                            <MenuFlyoutItem Click="Home_Click" Text="Home" Icon="Home"/>
                            <MenuFlyoutSeparator />
                            <MenuFlyoutItem Click="Exit_Click" Text="Exit">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE8BB;" />
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                        </muxc:MenuBarItem>

                    </muxc:MenuBar>

                    <Button
                    VerticalAlignment="Center"
                    Background="Transparent"
                    BorderBrush="Transparent"
                    Click="UndoButton_Click"
                    ToolTipService.ToolTip="Undo">
                        <Viewbox MaxWidth="17" MaxHeight="17">
                            <SymbolIcon Symbol="Undo" />
                        </Viewbox>
                    </Button>

                    <Button
                    VerticalAlignment="Center"
                    Background="Transparent"
                    BorderBrush="Transparent"
                    Click="RedoButton_Click"
                    ToolTipService.ToolTip="Redo">
                        <Viewbox MaxWidth="17" MaxHeight="17">
                            <SymbolIcon Symbol="Redo" />
                        </Viewbox>
                    </Button>

                    <AppBarSeparator />

                    <Button
                    Background="Transparent"
                    BorderBrush="Transparent"
                    Click="ShareButton_Click"
                    ToolTipService.ToolTip="Share">
                        <Viewbox MaxWidth="17" MaxHeight="17">
                            <SymbolIcon Symbol="Share" />
                        </Viewbox>
                    </Button>

                    <Button
                    Background="Transparent"
                    BorderBrush="Transparent"
                    Click="CommentsButton_Click"
                    ToolTipService.ToolTip="Comment">
                        <Viewbox MaxWidth="17" MaxHeight="17">
                            <SymbolIcon Symbol="Message" />
                        </Viewbox>
                    </Button>

                    <Button
                    Background="Transparent"
                    BorderBrush="Transparent"
                    Click="SettingsButton_Click"
                    ToolTipService.ToolTip="Settings">
                        <Viewbox MaxWidth="17" MaxHeight="17">
                            <SymbolIcon Symbol="Setting" />
                        </Viewbox>
                    </Button>
                </StackPanel>

                <controls:TabbedCommandBar
                x:Name="ButtonPanel"
                Margin="0,0,0,0"
                Padding="0,0,0,0"
                RelativePanel.Below="MenuPanel"
                RelativePanel.AlignLeftWithPanel="True"
                RelativePanel.AlignRightWithPanel="True"
                Background="Transparent">
                    <controls:TabbedCommandBar.MenuItems>
                        <controls:TabbedCommandBarItem Header="Home" Background="Transparent">
                            <AppBarToggleButton
                    Click="BoldButton_Click" x:Name="BoldButton"
                    Style="{StaticResource TransparentToggleButton}"
                    ToolTipService.ToolTip="Bold">
                                <Viewbox MaxWidth="17" MaxHeight="17">
                                    <SymbolIcon Symbol="Bold" />
                                </Viewbox>
                            </AppBarToggleButton>

                            <AppBarToggleButton
                    Click="ItalicButton_Click" x:Name="ItalicButton"
                    Style="{StaticResource TransparentToggleButton}"
                    ToolTipService.ToolTip="Italic">
                                <Viewbox MaxWidth="17" MaxHeight="17">
                                    <SymbolIcon Symbol="Italic" />
                                </Viewbox>
                            </AppBarToggleButton>
                            <AppBarToggleButton
                    Click="UnderlineButton_Click" x:Name="UnderlineButton"
                    Style="{StaticResource TransparentToggleButton}"
                    ToolTipService.ToolTip="Underline">
                                <Viewbox MaxWidth="17" MaxHeight="17">
                                    <SymbolIcon Symbol="Underline" />
                                </Viewbox>
                            </AppBarToggleButton>
                            <AppBarToggleButton
                    Click="StrikethoughButton_Click" x:Name="StrikethroughButton"
                    Style="{StaticResource TransparentToggleButton}"
                    ToolTipService.ToolTip="Strikethrough">
                                <FontIcon FontSize="17" Glyph="&#xEDE0;" />
                            </AppBarToggleButton>
                            <AppBarSeparator />
                            <AppBarButton
                    Click="AlignLeftButton_Click"
                    Style="{StaticResource TransparentButton}"
                    ToolTipService.ToolTip="Align Left">
                                <Viewbox MaxWidth="17" MaxHeight="17">
                                    <SymbolIcon Symbol="AlignLeft" />
                                </Viewbox>
                            </AppBarButton>
                            <AppBarButton
                    Click="AlignCenterButton_Click"
                    Style="{StaticResource TransparentButton}"
                    ToolTipService.ToolTip="Align Center">
                                <Viewbox MaxWidth="17" MaxHeight="17">
                                    <SymbolIcon Symbol="AlignCenter" />
                                </Viewbox>
                            </AppBarButton>
                            <AppBarButton
                    Click="AlignRightButton_Click"
                    Style="{StaticResource TransparentButton}"
                    ToolTipService.ToolTip="Align Right">
                                <Viewbox MaxWidth="17" MaxHeight="17">
                                    <SymbolIcon Symbol="AlignRight" />
                                </Viewbox>
                            </AppBarButton>
                            <AppBarSeparator />
                            <AppBarElementContainer>
                                <!--<muxc:DropDownButton
                    x:Name="fontColorButton"
                    AutomationProperties.Name="FontColor"
                    BorderThickness="0"
                    RelativePanel.AlignRightWithPanel="True"
                    ToolTipService.ToolTip="FontColor">
                                <SymbolIcon Symbol="FontColor" />
                                <muxc:DropDownButton.Flyout>
                                    <Flyout Placement="Bottom">
                                        <RelativePanel>
                                            <VariableSizedWrapGrid
                                    x:Name="colorGrid"
                                    MaximumRowsOrColumns="4"
                                    Orientation="Horizontal">
                                                <VariableSizedWrapGrid.Resources>
                                                    <Style TargetType="Rectangle">
                                                        <Setter Property="Width" Value="32" />
                                                        <Setter Property="Height" Value="32" />
                                                    </Style>

                                                    <Style TargetType="Button">
                                                        <Setter Property="Padding" Value="0" />
                                                        <Setter Property="MinWidth" Value="0" />
                                                        <Setter Property="MinHeight" Value="0" />
                                                        <Setter Property="Margin" Value="5" />
                                                        <Setter Property="CornerRadius" Value="8" />
                                                    </Style>
                                                </VariableSizedWrapGrid.Resources>
                                                <Button
                                        AutomationProperties.Name="Red"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Red">
                                                    <Button.Content>
                                                        <Rectangle Fill="Red" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Orange"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Orange">
                                                    <Button.Content>
                                                        <Rectangle Fill="Orange" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Yellow"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Yellow">
                                                    <Button.Content>
                                                        <Rectangle Fill="Yellow" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Green"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Green">
                                                    <Button.Content>
                                                        <Rectangle Fill="Green" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Blue"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Blue">
                                                    <Button.Content>
                                                        <Rectangle Fill="Blue" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="LightBlue"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Light Blue">
                                                    <Button.Content>
                                                        <Rectangle Fill="LightBlue" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Indigo"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Indigo">
                                                    <Button.Content>
                                                        <Rectangle Fill="Indigo" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Violet"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Violet">
                                                    <Button.Content>
                                                        <Rectangle Fill="Violet" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Gray"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Gray">
                                                    <Button.Content>
                                                        <Rectangle Fill="Gray" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Beige"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Beige">
                                                    <Button.Content>
                                                        <Rectangle Fill="Beige" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Black"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="Black">
                                                    <Button.Content>
                                                        <Rectangle Fill="Black" />
                                                    </Button.Content>
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="White"
                                        Click="ColorButton_Click"
                                        ToolTipService.ToolTip="White">
                                                    <Button.Content>
                                                        <Rectangle Fill="White" />
                                                    </Button.Content>
                                                </Button>
                                            </VariableSizedWrapGrid>
                                            <Button
                                    x:Name="colorPickerButton"
                                    Width="173"
                                    Margin="0,8,0,0"
                                    Content="More colors"
                                    Flyout="{StaticResource myColorPickerFlyout}"
                                    RelativePanel.Below="colorGrid" />
                                        </RelativePanel>
                                    </Flyout>
                                </muxc:DropDownButton.Flyout>
                            </muxc:DropDownButton>-->
                                <muxc:SplitButton x:Name="fontcolorsplitbutton" Grid.Column="6" Content="&#xE186;" Grid.Row="1" FontFamily="{ThemeResource SymbolThemeFontFamily}" VerticalContentAlignment="Stretch" FontSize="16" Click="fontcolorsplitbutton_Click">
                                    <muxc:SplitButton.Flyout>
                                        <Flyout Placement="Bottom">
                                            <RelativePanel>
                                                <VariableSizedWrapGrid x:Name="colorGrid" MaximumRowsOrColumns="6" RelativePanel.Below="Autobutton" Margin="0,3,0,3">
                                                    <VariableSizedWrapGrid.Resources>
                                                        <Style TargetType="Rectangle">
                                                            <Setter Property="Width" Value="25"/>
                                                            <Setter Property="Height" Value="25"/>
                                                        </Style>

                                                        <Style TargetType="Button">
                                                            <Setter Property="Padding" Value="0"/>
                                                            <Setter Property="Width" Value="25"/>
                                                            <Setter Property="Height" Value="25"/>
                                                            <Setter Property="MinWidth" Value="0"/>
                                                            <Setter Property="MinHeight" Value="0"/>
                                                            <Setter Property="Margin" Value="3"/>
                                                            <Setter Property="CornerRadius" Value="15"/>
                                                            <Setter Property="Background"
                                Value="Transparent" />
                                                            <Setter Property="BackgroundSizing"
                                Value="OuterBorderEdge" />
                                                            <Setter Property="BorderBrush"
                                Value="Transparent" />
                                                            <Setter Property="Padding"
                                Value="0" />
                                                            <Setter Property="FontWeight"
                                Value="Normal" />
                                                            <Setter Property="FontSize"
                                Value="16" />


                                                        </Style>
                                                    </VariableSizedWrapGrid.Resources>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="White">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#ffffff"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Grey">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#a5a5a5"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Dark Grey">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#666666"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Dark Grey">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#666666"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Black">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#333333"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Black">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#000000"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Red" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#ff0000"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Orange" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#ffc000"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Yellow" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#ffff00"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Green" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#00b050"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Blue" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#004dbb"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Purple">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#9b00d3"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Brick Red">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#c0504d"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Orange">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#f79646"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Olive Green">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#9bbb59"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Turquoise">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#4bacc6"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Azure">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#4f81bd"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Slate Grey">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#8064a2"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Copper Red">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#d16349"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Earth Orange">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#d19049"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Dark Yellow" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#ccb400"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Light Mint" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#8fb08c"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Blue Grey" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#646b86"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Brown">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#9e7c7c"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Earth Red" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#dd8484"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Orange" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#f3a447"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Yellow" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#dfce04"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Muted Green" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#a5b592"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Muted Blue" >
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#809ec2"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button Click="ColorButton_Click" ToolTipService.ToolTip="Lilac">
                                                        <Button.Content>
                                                            <Border CornerRadius="100" BorderBrush="#FFB7B7B7" BorderThickness="1" >
                                                                <Border CornerRadius="100" >
                                                                    <Rectangle Fill="#9c85c0"/>
                                                                </Border>
                                                            </Border>
                                                        </Button.Content>
                                                    </Button>
                                                </VariableSizedWrapGrid>
                                                <Button Flyout="{StaticResource myColorPickerFlyout}" RelativePanel.Below="colorGrid" Width="154" x:Name="colorPickerButton" FontFamily="Segoe UI" FontSize="11" Height="34">
                                                    <Button.Content>
                                                        <Grid>
                                                            <TextBlock Text="More colors..." Margin="25,0,0,0"></TextBlock>
                                                            <FontIcon Glyph="" HorizontalAlignment="Left" FontSize="16"></FontIcon>
                                                        </Grid>
                                                    </Button.Content>
                                                </Button>
                                                <ToggleButton Width="155" x:Name="Autobutton" FontFamily="Segoe UI" Height="35" Click="Autobutton_Click">
                                                    <ToggleButton.Content>
                                                        <Grid>
                                                            <TextBlock Text="Automatic" Margin="25,0,0,0" FontSize="11"></TextBlock>
                                                            <FontIcon Glyph="" HorizontalAlignment="Left" FontSize="16"></FontIcon>
                                                        </Grid>
                                                    </ToggleButton.Content>
                                                </ToggleButton>
                                            </RelativePanel>
                                        </Flyout>
                                    </muxc:SplitButton.Flyout>
                                </muxc:SplitButton>
                            </AppBarElementContainer>
                            <AppBarElementContainer>
                                <muxc:NumberBox
                    x:Name="FontSizeBox"
                    MinWidth="120"
                    Maximum="150"
                    Minimum="8"
                    PlaceholderText="Font size"
                    SpinButtonPlacementMode="Compact"
                    ValueChanged="FontSizeBox_ValueChanged"
                    Value="11" />
                            </AppBarElementContainer>
                            <AppBarElementContainer>
                                <ComboBox
                    x:Name="FontsCombo"
                    IsTextSearchEnabled="True"
                    ItemsSource="{x:Bind fonts}"
                    PlaceholderText="Font"
                    SelectedItem="Segoe UI"
                    SelectionChanged="FontsCombo_SelectionChanged">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate x:DataType="x:String">
                                            <TextBlock FontFamily="{x:Bind}" Text="{x:Bind}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </AppBarElementContainer>
                            <AppBarElementContainer>
                                <muxc:ToggleSplitButton x:Name="myListButton" Grid.Column="2" Grid.ColumnSpan="3" Padding="11,0,11,0">
                                    <muxc:ToggleSplitButton.Content>
                                        <FontIcon Glyph="&#xE133;" />
                                    </muxc:ToggleSplitButton.Content>
                                    <muxc:ToggleSplitButton.Flyout>
                                        <Flyout Placement="Bottom">
                                            <Grid>
                                                <Grid.Resources>
                                                    <Style TargetType="Button">
                                                        <Setter Property="Padding" Value="4"/>
                                                        <Setter Property="MinWidth" Value="0"/>
                                                        <Setter Property="MinHeight" Value="0"/>
                                                        <Setter Property="Margin" Value="6"/>
                                                        <Setter Property="CornerRadius" Value="{StaticResource ControlCornerRadius}"/>
                                                    </Style>
                                                </Grid.Resources>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>

                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <Button x:Name="NoneNumeral" Grid.Row="0" Grid.Column="0" Click="NoneNumeral_Click" Height="48" Width="48">
                                                    <FontIcon FontFamily="{ThemeResource SymbolThemeFontFamily}" Glyph="&#xE738;" />
                                                </Button>
                                                <Button x:Name="DottedNumeral" Grid.Row="0" Grid.Column="1" Click="DottedNumeral_Click" Height="48" Width="48">
                                                    <FontIcon FontFamily="{ThemeResource SymbolThemeFontFamily}" Glyph="&#xE8FD;" />
                                                </Button>
                                                <Button x:Name="NumberNumeral" Grid.Row="0" Grid.Column="2" Click="NumberNumeral_Click" Height="48" Width="48">
                                                    <FontIcon FontFamily="{ThemeResource SymbolThemeFontFamily}" Glyph="&#xF146;" />
                                                </Button>
                                                <Button x:Name="LetterSmallNumeral" Grid.Row="1" Grid.Column="0" Click="LetterSmallNumeral_Click" Height="48" Width="48">
                                                    <TextBlock Text="a" FontSize="24"/>
                                                </Button>
                                                <Button x:Name="LetterBigNumeral"  Grid.Row="1" Grid.Column="1" Click="LetterBigNumeral_Click" Height="48" Width="48">
                                                    <TextBlock Text="A" FontSize="24"/>
                                                </Button>
                                                <Button x:Name="SmalliNumeral" Grid.Row="1" Grid.Column="2" Click="SmalliNumeral_Click" Height="48" Width="48">
                                                    <TextBlock Text="i" FontSize="24"/>
                                                </Button>
                                                <Button x:Name="BigINumeral" Grid.Row="2" Grid.Column="0" Click="BigINumeral_Click" Height="48" Width="48">
                                                    <TextBlock Text="I" FontSize="24"/>
                                                </Button>
                                            </Grid>
                                        </Flyout>
                                    </muxc:ToggleSplitButton.Flyout>
                                </muxc:ToggleSplitButton>
                            </AppBarElementContainer>
                            <AppBarElementContainer>
                                <muxc:SplitButton x:Name="Back" FontFamily="{ThemeResource SymbolThemeFontFamily}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" FontSize="12" Padding="0,0,5,0" ToolTipService.ToolTip="Text highlight" BorderThickness="0,1,0,1">
                                    <muxc:SplitButton.Flyout>
                                        <Flyout>
                                            <StackPanel>
                                                <Grid >
                                                    <Button Background="DarkRed"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Red"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="50,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="OrangeRed"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="100,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="IndianRed"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="150,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="PaleVioletRed"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="200,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="HotPink"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="250,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Pink"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="300,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LightPink"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="350,0,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="DarkGreen"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" VerticalAlignment="Top" Margin="0,50,0,0"  Click="HighlightButton_Click"/>
                                                    <Button Background="DarkOliveGreen"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="50,50,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Green"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="100,50,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="ForestGreen"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="150,50,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LimeGreen"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="200,50,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Lime"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="250,50,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="SpringGreen"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="300,50,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="GreenYellow"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="350,50,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="DarkBlue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" VerticalAlignment="Top" Margin="0,100,0,0"  Click="HighlightButton_Click"/>
                                                    <Button Background="DarkSlateBlue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="50,100,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Blue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="100,100,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="CornflowerBlue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="150,100,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="DodgerBlue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="200,100,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="DeepSkyBlue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="250,100,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LightSkyBlue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="300,100,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LightBlue"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="350,100,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="DarkOrange"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" VerticalAlignment="Top" Margin="0,150,0,0"  Click="HighlightButton_Click"/>
                                                    <Button Background="Orange"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="50,150,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Yellow"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="100,150,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="AntiqueWhite"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="150,150,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LightGoldenrodYellow"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="200,150,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LightYellow"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="250,150,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="WhiteSmoke"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="300,150,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="FloralWhite"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="350,150,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Black"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" VerticalAlignment="Top" Margin="0,200,0,0"  Click="HighlightButton_Click"/>
                                                    <Button Background="DimGray"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="50,200,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="DarkGray"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="100,200,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Gray"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="150,200,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LightSlateGray"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="200,200,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="LightGray"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="250,200,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="White"  FontFamily="{ThemeResource SymbolThemeFontFamily}" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="300,200,0,0" VerticalAlignment="Top"  Click="HighlightButton_Click"/>
                                                    <Button Background="Transparent" Width="40" Height="40"  FontSize="36" Padding="0,0,0,0" Margin="350,200,0,0" VerticalAlignment="Top" Click="NullHighlightButton_Click">
                                                        <Border BorderBrush="Red" BorderThickness="1" Width="39" RenderTransformOrigin="0.5,0.5">
                                                            <Border.RenderTransform>
                                                                <CompositeTransform Rotation="46.118"/>
                                                            </Border.RenderTransform>
                                                        </Border>
                                                    </Button>
                                                </Grid>
                                                <ColorPicker x:Name="BackPicker" ColorChanged="BackPicker_ColorChanged" Color="#00000000" Margin="0,15,0,0"/>
                                            </StackPanel>
                                        </Flyout>
                                    </muxc:SplitButton.Flyout>
                                    <Grid>
                                        <TextBlock x:Name="BackAccent" Text="&#xE891;" Foreground="White"  FontSize="14"/>
                                        <Border Background="#FFFFBB00" Margin="1,1,1,11"/>
                                        <Border Background="#FFFF9800" Margin="2,5,2,8" CornerRadius="0,0,1,1"/>
                                        <TextBlock Text="&#xE193;"  FontSize="14" Foreground="{Binding Foreground, ElementName=BorTextAccent}"/>
                                    </Grid>
                                </muxc:SplitButton>
                            </AppBarElementContainer>
                            <AppBarSeparator />
                            <AppBarButton Style="{StaticResource TransparentButton}" ToolTipService.ToolTip="FindDoc" Click="FindButton2_Click">
                                <Button.Content>
                                    <Viewbox MaxWidth="17" MaxHeight="17">
                                        <SymbolIcon Symbol="Find" />
                                    </Viewbox>
                                </Button.Content>
                            </AppBarButton>
                            <AppBarSeparator />
                            <AppBarToggleButton Click="SubscriptButton_Click" Label="Subscript">
                                <AppBarToggleButton.Icon>
                                    <PathIcon Data="M16.488 4.43a.75.75 0 0 1 .082 1.058L10.988 12l5.032 5.871c-.302.41-.555.906-.682 1.51L10 13.151l-5.43 6.336a.75.75 0 0 1-1.14-.976L9.013 12 3.431 5.488a.75.75 0 0 1 1.139-.976L10 10.848l5.43-6.336a.75.75 0 0 1 1.058-.081ZM17.75 15.523c0-.528.444-1.023.986-1.023.407 0 .735.19.893.434.136.21.218.566-.093 1.095-.15.255-.376.482-.682.724-.152.12-.316.237-.493.363l-.074.052c-.152.107-.315.222-.472.34-.744.56-1.565 1.346-1.565 2.742 0 .414.336.75.75.75h3.451a.75.75 0 0 0 0-1.5h-2.513c.16-.282.423-.525.779-.793.137-.103.279-.203.432-.312l.078-.054c.178-.127.37-.264.557-.41.372-.295.76-.658 1.045-1.142.557-.948.546-1.921.058-2.672C20.42 13.4 19.59 13 18.736 13c-1.478 0-2.486 1.278-2.486 2.523a.75.75 0 0 0 1.5 0Z"/>
                                </AppBarToggleButton.Icon>
                            </AppBarToggleButton>
                            <AppBarToggleButton Click="SuperScriptButton_Click" Label="Superscript">
                                <AppBarToggleButton.Icon>
                                    <PathIcon Data="M18.736 3.5c-.543 0-.986.495-.986 1.023a.75.75 0 0 1-1.5 0C16.25 3.278 17.258 2 18.736 2c.855 0 1.684.4 2.15 1.117.49.751.5 1.724-.057 2.672-.285.484-.673.847-1.045 1.141-.187.148-.379.284-.557.41l-.078.056a17.45 17.45 0 0 0-.432.311c-.356.268-.619.511-.78.793h2.514a.75.75 0 0 1 0 1.5H17a.75.75 0 0 1-.75-.75c0-1.396.821-2.182 1.565-2.741.157-.119.32-.234.472-.341l.074-.052c.177-.126.34-.243.493-.363.306-.242.532-.47.682-.724.31-.53.229-.886.093-1.094-.158-.244-.486-.435-.893-.435Z M15.26 4.71c.06.562.385 1.043.847 1.318L10.987 12l5.583 6.512a.75.75 0 1 1-1.14.976L10 13.152l-5.43 6.336a.75.75 0 0 1-1.14-.976L9.013 12 3.431 5.488a.75.75 0 1 1 1.139-.976L10 10.848l5.26-6.137Z"/>
                                </AppBarToggleButton.Icon>
                            </AppBarToggleButton>
                            <AppBarSeparator />
                            <AppBarButton
                    Click="AddImageButton_Click"
                    Style="{StaticResource TransparentButton}"
                    ToolTipService.ToolTip="AddImage">
                                <FontIcon FontSize="17" Glyph="&#xE8B9;" />
                            </AppBarButton>
                            <AppBarButton
                    x:Name="AddLinkButton"
                    Style="{StaticResource TransparentButton}"
                    ToolTipService.ToolTip="AddHyperlink">
                                <Button.Content>
                                    <FontIcon FontSize="17" Glyph="&#xE71B;" />
                                </Button.Content>
                                <Button.Flyout>
                                    <Flyout Placement="Bottom">
                                        <StackPanel Orientation="Vertical">
                                            <TextBox x:Name="hyperlinkText" PlaceholderText="Link" AllowFocusOnInteraction="True"/>
                                            <Button Margin="0,10,0,0" Click="AddLinkButton_Click">Add hyperlink to selected text</Button>
                                        </StackPanel>
                                    </Flyout>
                                </Button.Flyout>
                            </AppBarButton>
                            <AppBarButton
                    Click="DateInsertionAsync"
                    Style="{StaticResource TransparentButton}"
                    ToolTipService.ToolTip="Insert current Date/Time">
                                <FontIcon FontSize="17" Glyph="&#xE163;" />
                            </AppBarButton>
                            <AppBarButton
                    Click="AddTableButton_Click"
                    Style="{StaticResource TransparentButton}"
                    ToolTipService.ToolTip="AddTable">
                                <FontIcon FontSize="17" Glyph="&#xF261;" />
                            </AppBarButton>
                            <AppBarButton
                    Click="AddSymbolButton_Click"
                            x:Name="symbolbut"
                    Style="{StaticResource TransparentButton}"
                    ToolTipService.ToolTip="AddSymbol">
                                <FontIcon FontSize="17" Glyph="&#xED58;" />
                                <AppBarButton.Flyout>
                                    <Flyout Placement="Bottom" x:Name="symbolsflyout">
                                        <RelativePanel>
                                            <StackPanel>
                                                <VariableSizedWrapGrid
                                    x:Name="symbolGrid"
                                    MaximumRowsOrColumns="4"
                                    Orientation="Horizontal">
                                                <VariableSizedWrapGrid.Resources>
                                                    <Style TargetType="Rectangle">
                                                        <Setter Property="Width" Value="32" />
                                                        <Setter Property="Height" Value="32" />
                                                    </Style>

                                                    <Style TargetType="Button">
                                                        <Setter Property="Padding" Value="0" />
                                                        <Setter Property="MinWidth" Value="32" />
                                                        <Setter Property="MinHeight" Value="32" />
                                                        <Setter Property="Margin" Value="5" />
                                                        <Setter Property="CornerRadius" Value="8" />
                                                    </Style>
                                                </VariableSizedWrapGrid.Resources>
                                                <Button
                                        AutomationProperties.Name="Mutiply"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Multiplication symbol"
                                         Content="×">
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Divide"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Division symbol"
                                                Content="÷">
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="LeftArrow"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Left Arrow symbol"
                                                Content="←">
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="RightArrow"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Right Arrow symbol"
                                                Content="→">
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Degree"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Degree symbol"
                                                Content="°">
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Paragraph"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Paragraph symbol"
                                                Content="§">
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="Mu"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Lowercase mu (micro) symbol"
                                                Content="µ">
                                                </Button>
                                                <Button
                                        AutomationProperties.Name="SquareRoot"
                                        Click="SymbolButton_Click"
                                        ToolTipService.ToolTip="Square root symbol"
                                                Content="√">
                                                </Button>

                                            </VariableSizedWrapGrid>
                                            <Button Content="More symbols" Click="more_symbols"/>
                                            </StackPanel>
                                        </RelativePanel>
                                    </Flyout>
                                </AppBarButton.Flyout>
                            </AppBarButton>
                            <AppBarButton
Click="ComputeHash_Click"
Style="{StaticResource TransparentButton}"
ToolTipService.ToolTip="Compute Hash">
                                <FontIcon FontSize="17" Glyph="&#xE943;" />
                            </AppBarButton>
                        </controls:TabbedCommandBarItem>
                        <controls:TabbedCommandBarItem Header="Edit" Background="Transparent">
                            <AppBarButton Click="UndoButton_Click" Label="Undo" Icon="Undo" />
                            <AppBarButton Click="RedoButton_Click" Label="Redo" Icon="Redo"/>
                            <AppBarSeparator />
                            <AppBarButton Click="CutButton_Click" Label="Cut" Icon="Cut"/>
                            <AppBarButton Click="CopyButton_Click" Label="Copy" Icon="Copy"/>
                            <AppBarButton Click="PasteButton_Click" Label="Paste" Icon="Paste"/>
                        </controls:TabbedCommandBarItem>
                        <controls:TabbedCommandBarItem x:Name="commentstabitem"
                                               Header="Comments"
                                               IsContextual="True"
                                               Visibility="Collapsed"
                                                        Background="Transparent">
                            <AppBarButton Label="Hide Comments UI" Icon="LeaveChat" Click="closecomments"/>
                        </controls:TabbedCommandBarItem>
                        <controls:TabbedCommandBarItem Header="Help" Background="Transparent">
                            <AppBarButton Label="About" Click="AboutBtn_Click">
                                <AppBarButton.Icon>
                                    <SymbolIcon Symbol="Help"/>
                                </AppBarButton.Icon>
                            </AppBarButton>
                            <AppBarButton Label="utever" Icon="Help" Click="uteverclick">
                            </AppBarButton>
                            <AppBarSeparator/>
                            <AppBarButton Label="First Run Dialog" Icon="Help" Click="fr_invoke"/>
                            <AppBarButton Label="What's New Dialog" Icon="Help" Click="WN_invoke"/>
                        </controls:TabbedCommandBarItem>
                    </controls:TabbedCommandBar.MenuItems>
                </controls:TabbedCommandBar>
            </RelativePanel>

            <SplitView
            RelativePanel.AlignBottomWithPanel="True"
            RelativePanel.AlignLeftWithPanel="True"
            RelativePanel.AlignRightWithPanel="True"
            RelativePanel.Below="containerPanel"
            muxc:BackdropMaterial.ApplyToRootOrPageBackground="True"
            Background="Transparent"
            PaneBackground="Transparent"
            IsPaneOpen="False" OpenPaneLength="256" CompactPaneLength="24" DisplayMode="Inline" PanePlacement="Right" x:Name="textsplitview">
                <SplitView.Pane>
                    <Grid Background="Transparent">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <StackPanel Orientation="Vertical" Background="Transparent">
                            <muxc:InfoBar IsOpen="True" Severity="Informational" Title="Usage info">
                                <muxc:InfoBar.Content>
                                    <TextBlock Text="Do not abuse the Find and Replace feature by trying to replace too many characters. Hangs or crashes may occur upon intentional overload." TextWrapping="WrapWholeWords"/>
                                </muxc:InfoBar.Content>
                            </muxc:InfoBar>
                            <TextBox x:Name="FindTextBox" TextWrapping="Wrap" AcceptsReturn="True" PlaceholderText="Find" Margin="10,10,10,0" Visibility="Visible"/>
                            <TextBox x:Name="ReplaceBox" TextWrapping="Wrap" AcceptsReturn="True" PlaceholderText="Replace" Margin="10,10,10,0"/>
                            <CheckBox x:Name="CaseSensBox" Content="Case sensitive" Margin="10,10,0,0"/>
                            <CheckBox x:Name="FullWordsBox" Content="Match whole words" Margin="10,0,0,0"/>
                            <Button x:Name="FindBTN" Content="Find" HorizontalAlignment="Stretch" Click="FindBTN_Click"/>
                            <Button x:Name="RepBTN" Content="Replace" HorizontalAlignment="Stretch" Click="RepBTN_Click"/>
                            <Button x:Name="RepAllBTN" Content="Replace all" Click="RepAllBTN_Click" HorizontalAlignment="Stretch"/>
                            <Button x:Name="CancelFindRepBTN" Content="Cancel" HorizontalAlignment="Stretch" Click="CancelFindRepBTN_Click"/>
                            <AppBarButton HorizontalAlignment="Center" Icon="ClosePane" Label="Close" Click="closepane"/>
                        </StackPanel>
                    </Grid>
                </SplitView.Pane>
                <SplitView RelativePanel.AlignBottomWithPanel="True"
            RelativePanel.AlignLeftWithPanel="True"
            RelativePanel.AlignRightWithPanel="True"
            RelativePanel.Below="containerPanel"
            muxc:BackdropMaterial.ApplyToRootOrPageBackground="True"
            Background="Transparent"
            PaneBackground="Transparent"
            IsPaneOpen="False" OpenPaneLength="256" CompactPaneLength="24" DisplayMode="Inline" PanePlacement="Left" x:Name="commentsplitview">
                    <SplitView.Pane>
                        <RichEditBox x:Name="comments">

                        </RichEditBox>
                    </SplitView.Pane>
                    <Grid>
                        <RichEditBox
            x:Name="editor"
            Padding="11"
            FontFamily="Segoe UI"
            IsSpellCheckEnabled="False"
            SelectionFlyout="{x:Null}"
            TextWrapping="WrapWholeWords"
            TextChanged="RichEditBox_TextChanged" SelectionChanged="editor_SelectionChanged">
                            <RichEditBox.KeyboardAccelerators>
                                <KeyboardAccelerator Modifiers="Control" Key="B" Invoked="OnKeyboardAcceleratorInvoked" />
                                <KeyboardAccelerator Modifiers="Control" Key="I" Invoked="OnKeyboardAcceleratorInvoked" />
                                <KeyboardAccelerator Modifiers="Control" Key="U" Invoked="OnKeyboardAcceleratorInvoked" />
                                <KeyboardAccelerator Modifiers="Control" Key="S" Invoked="OnKeyboardAcceleratorInvoked" />
                            </RichEditBox.KeyboardAccelerators>
                        </RichEditBox>
                        <Grid x:Name="Bottom" RelativePanel.AlignBottomWithPanel="True" RelativePanel.AlignRightWithPanel="True" VerticalAlignment="Bottom" HorizontalAlignment="Right" Margin="0,5,0,5" Padding="0, 0, 0, 5">
                            <Border x:Name="StatusBar" BorderThickness="1" CornerRadius="3,3,3,3" VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="7,0,7,5" Height="35" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">
                                <Border.BorderBrush>
                                    <LinearGradientBrush EndPoint="0,3" MappingMode="Absolute">
                                        <LinearGradientBrush.RelativeTransform>
                                            <ScaleTransform CenterY="0.5" ScaleY="-1"/>
                                        </LinearGradientBrush.RelativeTransform>
                                        <GradientStop Color="#29000000" Offset="0.33"/>
                                        <GradientStop Color="#0F000000" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.BorderBrush>
                                <Grid Margin="0,0,0,-2">
                                    <StackPanel Orientation="Horizontal" Margin="10,5,0,5">
                                        <TextBlock x:Name="WordCount" Text="Word count: 0" Foreground="{ThemeResource DefaultTextForegroundThemeBrush}" VerticalAlignment="Center" Padding="0,0,7,0"/>
                                        <Grid x:Name="SelWordGrid" Margin="5,0,0,0" Padding="0,0,7,0">
                                            <Border BorderThickness="1" Background="#7FD0D0D0" CornerRadius="1,1,1,1" HorizontalAlignment="Left" Width="3"/>
                                            <TextBlock x:Name="SelWordCount" Text="Selected words: 0" Foreground="{ThemeResource DefaultTextForegroundThemeBrush}" VerticalAlignment="Center" Margin="8,0,0,0"/>
                                        </Grid>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </Grid>
                    </Grid>
                </SplitView>
            </SplitView>
            <Grid RelativePanel.AlignHorizontalCenterWithPanel="True" RelativePanel.AlignVerticalCenterWithPanel="True" RelativePanel.AlignBottomWithPanel="True" RelativePanel.AlignRightWithPanel="True" RelativePanel.AlignTopWithPanel="True" RelativePanel.AlignLeftWithPanel="True">
                <diags:MessageBoxesGrid>
                <diags:MessageBox x:Name="AboutBox" IsSingleButton="True" FirstButtonText="OK" Title="About" BlockUserInput="False" RememberPosition="False" MessageBoxHeight="370" MessageBoxWidth="400" d:IsHidden="True">
                    <Grid Margin="10,0,10,0">
                        <Image HorizontalAlignment="Left" Height="90" Margin="5,5,0,0" VerticalAlignment="Top" Width="90" Source="/Assets/utevericon.png"/>
                        <TextBlock Foreground="{ThemeResource DefaultTextForegroundThemeBrush}" HorizontalAlignment="Left" Margin="120,20,0,0" TextWrapping="Wrap" Text="UltraTextEdit UWP Plus" VerticalAlignment="Top" FontSize="16"/>
                        <TextBlock Foreground="{ThemeResource DefaultTextForegroundThemeBrush}" HorizontalAlignment="Left" Margin="120,50,0,0" TextWrapping="Wrap" VerticalAlignment="Top" FontSize="11">Version 10.0.25982.1000 - Dev Channel<LineBreak/>Copyright ©️ jpb/ErrorTek 2021-2024, © Ivirius 2024
<LineBreak/>Licensed under the MIT License</TextBlock>
                        <StackPanel Margin="0,120,0,0">
                            <HyperlinkButton Content="WinUI 2.8.6" Click="HyperlinkButton_Click"/>
                            <HyperlinkButton Content="Windows Community Toolkit 7.1.3" Click="HyperlinkButton_Click_1"/>
                            <HyperlinkButton Content="UWP (Universal Windows Platform)" Click="HyperlinkButton_Click_2"/>
                        </StackPanel>
                    </Grid>
                </diags:MessageBox>
            </diags:MessageBoxesGrid>
            </Grid>
        </RelativePanel>
    </Grid>
    
</Page>
